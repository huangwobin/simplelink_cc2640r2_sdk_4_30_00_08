<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.12">
  <compounddef id="_e_c_d_h_8h" kind="file" language="C++">
    <compoundname>ECDH.h</compoundname>
    <includes local="no">stdbool.h</includes>
    <includes local="no">stddef.h</includes>
    <includes local="no">stdint.h</includes>
    <includes refid="_crypto_key_8h" local="no">ti/drivers/cryptoutils/cryptokey/CryptoKey.h</includes>
    <includes refid="_e_c_c_params_8h" local="no">ti/drivers/cryptoutils/ecc/ECCParams.h</includes>
    <includedby refid="_e_c_d_h_c_c26_x2_8h" local="no">ECDHCC26X2.h</includedby>
    <incdepgraph>
      <node id="305">
        <label>stdbool.h</label>
      </node>
      <node id="308">
        <label>ti/drivers/cryptoutils/cryptokey/CryptoKey.h</label>
        <link refid="_crypto_key_8h"/>
        <childnode refid="307" relation="include">
        </childnode>
        <childnode refid="305" relation="include">
        </childnode>
      </node>
      <node id="304">
        <label>ECDH.h</label>
        <link refid="_e_c_d_h_8h"/>
        <childnode refid="305" relation="include">
        </childnode>
        <childnode refid="306" relation="include">
        </childnode>
        <childnode refid="307" relation="include">
        </childnode>
        <childnode refid="308" relation="include">
        </childnode>
        <childnode refid="309" relation="include">
        </childnode>
      </node>
      <node id="307">
        <label>stdint.h</label>
      </node>
      <node id="306">
        <label>stddef.h</label>
      </node>
      <node id="309">
        <label>ti/drivers/cryptoutils/ecc/ECCParams.h</label>
        <link refid="_e_c_c_params_8h"/>
        <childnode refid="307" relation="include">
        </childnode>
        <childnode refid="305" relation="include">
        </childnode>
        <childnode refid="308" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="310">
        <label>ECDH.h</label>
        <link refid="_e_c_d_h_8h"/>
        <childnode refid="311" relation="include">
        </childnode>
      </node>
      <node id="311">
        <label>ECDHCC26X2.h</label>
        <link refid="_e_c_d_h_c_c26_x2_8h"/>
      </node>
    </invincdepgraph>
    <innerclass refid="struct_e_c_d_h___config" prot="public">ECDH_Config</innerclass>
    <innerclass refid="struct_e_c_d_h___operation_generate_public_key" prot="public">ECDH_OperationGeneratePublicKey</innerclass>
    <innerclass refid="struct_e_c_d_h___operation_compute_shared_secret" prot="public">ECDH_OperationComputeSharedSecret</innerclass>
    <innerclass refid="union_e_c_d_h___operation" prot="public">ECDH_Operation</innerclass>
    <innerclass refid="struct_e_c_d_h___params" prot="public">ECDH_Params</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="_e_c_d_h_8h_1a00dbed059c824024835da32a82143cf9" prot="public" static="no">
        <name>ECDH_STATUS_RESERVED</name>
        <initializer>(-32)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Common ECDH status code reservation offset. ECC driver implementations should offset status codes with ECDH_STATUS_RESERVED growing negatively.</para><para>Example implementation specific status codes: <programlisting><codeline><highlight class="normal">#define<sp/>ECCXYZ_STATUS_ERROR0<sp/><sp/><sp/><sp/>ECDH_STATUS_RESERVED<sp/>-<sp/>0</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>ECCXYZ_STATUS_ERROR1<sp/><sp/><sp/><sp/>ECDH_STATUS_RESERVED<sp/>-<sp/>1</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>ECCXYZ_STATUS_ERROR2<sp/><sp/><sp/><sp/>ECDH_STATUS_RESERVED<sp/>-<sp/>2</highlight></codeline>
</programlisting> </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="327" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="327" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_d_h_8h_1aadb5927711e0215b36d2895573622a5f" prot="public" static="no">
        <name>ECDH_STATUS_SUCCESS</name>
        <initializer>(0)</initializer>
        <briefdescription>
<para>Successful status code. </para>        </briefdescription>
        <detaileddescription>
<para>Functions return ECDH_STATUS_SUCCESS if the function was executed successfully. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="335" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="335" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_d_h_8h_1a833a693cf04fcd2e6983105f9ff137c5" prot="public" static="no">
        <name>ECDH_STATUS_ERROR</name>
        <initializer>(-1)</initializer>
        <briefdescription>
<para>Generic error status code. </para>        </briefdescription>
        <detaileddescription>
<para>Functions return ECDH_STATUS_ERROR if the function was not executed successfully. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="343" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="343" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_d_h_8h_1ab70467d8fc82bab4e8e709273d6cd322" prot="public" static="no">
        <name>ECDH_STATUS_RESOURCE_UNAVAILABLE</name>
        <initializer>(-2)</initializer>
        <briefdescription>
<para>An error status code returned if the hardware or software resource is currently unavailable. </para>        </briefdescription>
        <detaileddescription>
<para>ECC driver implementations may have hardware or software limitations on how many clients can simultaneously perform operations. This status code is returned if the mutual exclusion mechanism signals that an operation cannot currently be performed. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="353" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="353" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_d_h_8h_1ad1255d673e521a12585d034ab228af3f" prot="public" static="no">
        <name>ECDH_STATUS_POINT_AT_INFINITY</name>
        <initializer>(-3)</initializer>
        <briefdescription>
<para>The result of the operation is the point at infinity. </para>        </briefdescription>
        <detaileddescription>
<para>The operation yielded the point at infinity on this curve. This point is not permitted for further use in ECC operations. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="361" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="361" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_d_h_8h_1a9858e344c1e0603f86645ae4928a3eca" prot="public" static="no">
        <name>ECDH_STATUS_PRIVATE_KEY_LARGER_EQUAL_ORDER</name>
        <initializer>(-4)</initializer>
        <briefdescription>
<para>The private key passed in is larger than the order of the curve. </para>        </briefdescription>
        <detaileddescription>
<para>Private keys must be integers in the interval [1, n - 1], where n is the order of the curve. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="369" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="369" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_d_h_8h_1ad4a3781705d2a5cf7850187828a27a58" prot="public" static="no">
        <name>ECDH_STATUS_PRIVATE_KEY_ZERO</name>
        <initializer>(-5)</initializer>
        <briefdescription>
<para>The private key passed in is zero. </para>        </briefdescription>
        <detaileddescription>
<para>Private keys must be integers in the interval [1, n - 1], where n is the order of the curve. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="377" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="377" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_d_h_8h_1aaf391c2c59fbf91364c2664b38af7bbe" prot="public" static="no">
        <name>ECDH_STATUS_PUBLIC_KEY_NOT_ON_CURVE</name>
        <initializer>(-6)</initializer>
        <briefdescription>
<para>The public key of the other party does not lie upon the curve. </para>        </briefdescription>
        <detaileddescription>
<para>The public key received from the other party does not lie upon the agreed upon curve. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="385" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="385" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_d_h_8h_1a0765420780e918aaa5814c077f59daec" prot="public" static="no">
        <name>ECDH_STATUS_PUBLIC_KEY_LARGER_THAN_PRIME</name>
        <initializer>(-7)</initializer>
        <briefdescription>
<para>A coordinate of the public key of the other party is too large. </para>        </briefdescription>
        <detaileddescription>
<para>A coordinate of the public key received from the other party is larger than the prime of the curve. This implies that the point was not correctly generated on that curve. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="394" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="394" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_d_h_8h_1aabdb2de28f3e3acd88275dc0cdc573c0" prot="public" static="no">
        <name>ECDH_STATUS_CANCELED</name>
        <initializer>(-8)</initializer>
        <briefdescription>
<para>The ongoing operation was canceled. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="399" column="9" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="399" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="enum">
      <memberdef kind="enum" id="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670" prot="public" static="no">
        <name>ECDH_ReturnBehavior</name>
        <enumvalue id="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670aab484909ed8c542b06511a66cc52ef18" prot="public">
          <name>ECDH_RETURN_BEHAVIOR_CALLBACK</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will return immediately while the ECC operation goes on in the background. The registered callback function is called after the operation completes. The context the callback function is called (task, HWI, SWI) is implementation-dependent. </para>          </detaileddescription>
        </enumvalue>
        <enumvalue id="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670ad76afb7626a0e43453bd8d7713eae59a" prot="public">
          <name>ECDH_RETURN_BEHAVIOR_BLOCKING</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will block while ECC operation goes on in the background. ECC operation results are available after the function returns. </para>          </detaileddescription>
        </enumvalue>
        <enumvalue id="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670a91e4b64cb2e16e67d8d3085efb31cc52" prot="public">
          <name>ECDH_RETURN_BEHAVIOR_POLLING</name>
          <initializer>= 4</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will continuously poll a flag while ECC operation goes on in the background. ECC operation results are available after the function returns. </para>          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>The way in which ECC function calls return after performing an encryption + authentication or decryption + verification operation. </para>        </briefdescription>
        <detaileddescription>
<para>Not all ECC operations exhibit the specified return behavor. Functions that do not require significant computation and cannot offload that computation to a background thread behave like regular functions. Which functions exhibit the specfied return behavior is not implementation dependent. Specifically, a software-backed implementation run on the same CPU as the application will emulate the return behavior while not actually offloading the computation to the background thread.</para><para>ECC functions exhibiting the specified return behavior have restrictions on the context from which they may be called.</para><para><table rows="4" cols="4"><row>
<entry thead="yes"><para></para></entry><entry thead="yes"><para>Task </para></entry><entry thead="yes"><para>Hwi </para></entry><entry thead="yes"><para>Swi  </para></entry></row>
<row>
<entry thead="no"><para>ECDH_RETURN_BEHAVIOR_CALLBACK </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry></row>
<row>
<entry thead="no"><para>ECDH_RETURN_BEHAVIOR_BLOCKING </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para></para></entry><entry thead="no"><para></para></entry></row>
<row>
<entry thead="no"><para>ECDH_RETURN_BEHAVIOR_POLLING </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry></row>
</table>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="427" column="1" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="427" bodyend="442"/>
      </memberdef>
      <memberdef kind="enum" id="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490" prot="public" static="no">
        <name>ECDH_OperationType</name>
        <enumvalue id="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490a62570c7af35bd230669defb259782d16" prot="public">
          <name>ECDH_OPERATION_TYPE_GENERATE_PUBLIC_KEY</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490a5cd7dd7ccef7e1a2cda0dda6b6a309e5" prot="public">
          <name>ECDH_OPERATION_TYPE_COMPUTE_SHARED_SECRET</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Enum for the operation types supported by the driver. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="506" column="1" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="506" bodyend="509"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="typedef">
      <memberdef kind="typedef" id="_e_c_d_h_8h_1a4315ab9071ba852159e436a2c5684a51" prot="public" static="no">
        <type>struct <ref refid="struct_e_c_d_h___config" kindref="compound">ECDH_Config</ref> *</type>
        <definition>typedef struct ECDH_Config* ECDH_Handle</definition>
        <argsstring></argsstring>
        <name>ECDH_Handle</name>
        <briefdescription>
<para>A handle that is returned from an <ref refid="_e_c_d_h_8h_1a4c10865a8a3c33937111b8a379e3783b" kindref="member">ECDH_open()</ref> call. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="404" column="1" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="404" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="_e_c_d_h_8h_1ae9a844cbf00537e5b1fd8dfa577a82df" prot="public" static="no">
        <type>struct <ref refid="struct_e_c_d_h___config" kindref="compound">ECDH_Config</ref></type>
        <definition>typedef struct ECDH_Config  ECDH_Config</definition>
        <argsstring></argsstring>
        <name>ECDH_Config</name>
        <briefdescription>
<para>ECC Global configuration. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="struct_e_c_d_h___config" kindref="compound">ECDH_Config</ref> structure contains a set of pointers used to characterize the ECC driver implementation.</para><para>This structure needs to be defined before calling <ref refid="_e_c_d_h_8h_1aeafc9a67220447bca292685b6b2e7640" kindref="member">ECDH_init()</ref> and it must not be changed thereafter.</para><para><simplesect kind="see"><para><ref refid="_e_c_d_h_8h_1aeafc9a67220447bca292685b6b2e7640" kindref="member">ECDH_init()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="462" column="1"/>
      </memberdef>
      <memberdef kind="typedef" id="_e_c_d_h_8h_1a978c9e16d670371e7c0c50793fc4ec04" prot="public" static="no">
        <type>void(*</type>
        <definition>typedef void(* ECDH_CallbackFxn) (ECDH_Handle handle, int_fast16_t returnStatus, ECDH_Operation operation, ECDH_OperationType operationType)</definition>
        <argsstring>)(ECDH_Handle handle, int_fast16_t returnStatus, ECDH_Operation operation, ECDH_OperationType operationType)</argsstring>
        <name>ECDH_CallbackFxn</name>
        <briefdescription>
<para>The definition of a callback function used by the ECDH driver when used in <ref refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670aab484909ed8c542b06511a66cc52ef18" kindref="member">ECDH_RETURN_BEHAVIOR_CALLBACK</ref>. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>Handle of the client that started the ECDH operation.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>returnStatus</parametername>
</parameternamelist>
<parameterdescription>
<para>The result of the ECDH operation. May contain an error code if the result is the point at infinity for example.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A union of pointers to operation structs. Only one type of pointer is valid per call to the callback function. Which type is currently valid is determined by /c operationType. The union allows easier access to the struct&apos;s fields without the need to typecase the result.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operationType</parametername>
</parameternamelist>
<parameterdescription>
<para>This parameter determined which operation the callback refers to and which type to access through /c operation. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="529" column="1" bodyfile="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" bodystart="529" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="_e_c_d_h_8h_1ad97202536e7a3ea20529969825b5c389" prot="public" static="no" mutable="no">
        <type>const <ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref></type>
        <definition>const ECDH_Params ECDH_defaultParams</definition>
        <argsstring></argsstring>
        <name>ECDH_defaultParams</name>
        <briefdescription>
<para>Default <ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref> structure. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="see"><para><ref refid="_e_c_d_h_8h_1aba742374e7813cd416d26a1b86872bf4" kindref="member">ECDH_Params_init()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="556" column="1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="_e_c_d_h_8h_1aeafc9a67220447bca292685b6b2e7640" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECDH_init</definition>
        <argsstring>(void)</argsstring>
        <name>ECDH_init</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>This function initializes the ECC module. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para>The ECDH_config structure must exist and be persistent before this function can be called. This function must also be called before any other ECC driver APIs. This function call does not modify any peripheral registers. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="566" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_d_h_8h_1aba742374e7813cd416d26a1b86872bf4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECDH_Params_init</definition>
        <argsstring>(ECDH_Params *params)</argsstring>
        <name>ECDH_Params_init</name>
        <param>
          <type><ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>Function to initialize the <ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>params</parametername>
</parameternamelist>
<parameterdescription>
<para>An pointer to <ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are: returnBehavior = ECDH_RETURN_BEHAVIOR_BLOCKING callbackFxn = NULL timeout = SemaphoreP_WAIT_FOREVER custom = NULL </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="580" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_d_h_8h_1a4c10865a8a3c33937111b8a379e3783b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="_e_c_d_h_8h_1a4315ab9071ba852159e436a2c5684a51" kindref="member">ECDH_Handle</ref></type>
        <definition>ECDH_Handle ECDH_open</definition>
        <argsstring>(uint_least8_t index, ECDH_Params *params)</argsstring>
        <name>ECDH_open</name>
        <param>
          <type>uint_least8_t</type>
          <declname>index</declname>
        </param>
        <param>
          <type><ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>This function opens a given ECC peripheral. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para>ECC controller has been initialized using <ref refid="_e_c_d_h_8h_1aeafc9a67220447bca292685b6b2e7640" kindref="member">ECDH_init()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>index</parametername>
</parameternamelist>
<parameterdescription>
<para>Logical peripheral number for the ECC indexed into the ECDH_config table</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>params</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to an parameter block, if NULL it will use default values.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>An ECDH_Handle on success or a NULL on an error or if it has been opened already.</para></simplesect>
<simplesect kind="see"><para><ref refid="_e_c_d_h_8h_1aeafc9a67220447bca292685b6b2e7640" kindref="member">ECDH_init()</ref> </para></simplesect>
<simplesect kind="see"><para><ref refid="_e_c_d_h_8h_1a47f6da8d23ef19680b27354e424dfcc1" kindref="member">ECDH_close()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="599" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_d_h_8h_1a47f6da8d23ef19680b27354e424dfcc1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECDH_close</definition>
        <argsstring>(ECDH_Handle handle)</argsstring>
        <name>ECDH_close</name>
        <param>
          <type><ref refid="_e_c_d_h_8h_1a4315ab9071ba852159e436a2c5684a51" kindref="member">ECDH_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <briefdescription>
<para>Function to close an ECC peripheral specified by the ECC handle. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para><ref refid="_e_c_d_h_8h_1a4c10865a8a3c33937111b8a379e3783b" kindref="member">ECDH_open()</ref> has to be called first.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>An ECC handle returned from <ref refid="_e_c_d_h_8h_1a4c10865a8a3c33937111b8a379e3783b" kindref="member">ECDH_open()</ref></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="_e_c_d_h_8h_1a4c10865a8a3c33937111b8a379e3783b" kindref="member">ECDH_open()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="610" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_d_h_8h_1a3828b70f1353f25ed32ce4daff66b5be" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECDH_OperationGeneratePublicKey_init</definition>
        <argsstring>(ECDH_OperationGeneratePublicKey *operation)</argsstring>
        <name>ECDH_OperationGeneratePublicKey_init</name>
        <param>
          <type><ref refid="struct_e_c_d_h___operation_generate_public_key" kindref="compound">ECDH_OperationGeneratePublicKey</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_e_c_d_h___operation_generate_public_key" kindref="compound">ECDH_OperationGeneratePublicKey</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to <ref refid="struct_e_c_d_h___operation_generate_public_key" kindref="compound">ECDH_OperationGeneratePublicKey</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="620" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_d_h_8h_1ad2eb16f459a7dad3cf51db76c74400bb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECDH_OperationComputeSharedSecret_init</definition>
        <argsstring>(ECDH_OperationComputeSharedSecret *operation)</argsstring>
        <name>ECDH_OperationComputeSharedSecret_init</name>
        <param>
          <type><ref refid="struct_e_c_d_h___operation_compute_shared_secret" kindref="compound">ECDH_OperationComputeSharedSecret</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_e_c_d_h___operation_compute_shared_secret" kindref="compound">ECDH_OperationComputeSharedSecret</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to <ref refid="struct_e_c_d_h___operation_compute_shared_secret" kindref="compound">ECDH_OperationComputeSharedSecret</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="630" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_d_h_8h_1af674c6e1f24af5212f0694ac033b3542" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t ECDH_generatePublicKey</definition>
        <argsstring>(ECDH_Handle handle, ECDH_OperationGeneratePublicKey *operation)</argsstring>
        <name>ECDH_generatePublicKey</name>
        <param>
          <type><ref refid="_e_c_d_h_8h_1a4315ab9071ba852159e436a2c5684a51" kindref="member">ECDH_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_e_c_d_h___operation_generate_public_key" kindref="compound">ECDH_OperationGeneratePublicKey</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Generates a public key for use in key agreement. </para>        </briefdescription>
        <detaileddescription>
<para>ECDH_generateKey() can be used for generating ephemeral keys.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A ECC handle returned from <ref refid="_e_c_d_h_8h_1a4c10865a8a3c33937111b8a379e3783b" kindref="member">ECDH_open()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the requisite parameters to execute the function.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="pre"><para>Call <ref refid="_e_c_d_h_8h_1a3828b70f1353f25ed32ce4daff66b5be" kindref="member">ECDH_OperationGeneratePublicKey_init()</ref> on <computeroutput>operation</computeroutput>.</para></simplesect>
<simplesect kind="post"><para><ref refid="_e_c_d_h_8h_1aac7cce4647109da02f1f4f952697ae85" kindref="member">ECDH_computeSharedSecret()</ref></para></simplesect>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1aadb5927711e0215b36d2895573622a5f" kindref="member">ECDH_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1a833a693cf04fcd2e6983105f9ff137c5" kindref="member">ECDH_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1ab70467d8fc82bab4e8e709273d6cd322" kindref="member">ECDH_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1aabdb2de28f3e3acd88275dc0cdc573c0" kindref="member">ECDH_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1ad1255d673e521a12585d034ab228af3f" kindref="member">ECDH_STATUS_POINT_AT_INFINITY</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The computed public key is the point at infinity. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1ad4a3781705d2a5cf7850187828a27a58" kindref="member">ECDH_STATUS_PRIVATE_KEY_ZERO</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The provided private key is zero. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="654" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_d_h_8h_1aac7cce4647109da02f1f4f952697ae85" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t ECDH_computeSharedSecret</definition>
        <argsstring>(ECDH_Handle handle, ECDH_OperationComputeSharedSecret *operation)</argsstring>
        <name>ECDH_computeSharedSecret</name>
        <param>
          <type><ref refid="_e_c_d_h_8h_1a4315ab9071ba852159e436a2c5684a51" kindref="member">ECDH_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_e_c_d_h___operation_compute_shared_secret" kindref="compound">ECDH_OperationComputeSharedSecret</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Computes a shared secret. </para>        </briefdescription>
        <detaileddescription>
<para>This secret can be used to generate shared keys for encryption and authentication.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A ECC handle returned from <ref refid="_e_c_d_h_8h_1a4c10865a8a3c33937111b8a379e3783b" kindref="member">ECDH_open()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the requisite</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="pre"><para>Call <ref refid="_e_c_d_h_8h_1ad2eb16f459a7dad3cf51db76c74400bb" kindref="member">ECDH_OperationComputeSharedSecret_init()</ref> on <computeroutput>operation</computeroutput>. Generate a shared secret off-chip or using <ref refid="_e_c_d_h_8h_1af674c6e1f24af5212f0694ac033b3542" kindref="member">ECDH_generatePublicKey()</ref></para></simplesect>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1aadb5927711e0215b36d2895573622a5f" kindref="member">ECDH_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1a833a693cf04fcd2e6983105f9ff137c5" kindref="member">ECDH_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1ab70467d8fc82bab4e8e709273d6cd322" kindref="member">ECDH_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1aabdb2de28f3e3acd88275dc0cdc573c0" kindref="member">ECDH_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1aaf391c2c59fbf91364c2664b38af7bbe" kindref="member">ECDH_STATUS_PUBLIC_KEY_NOT_ON_CURVE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The foreign public key is not a point on the specified curve. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1a0765420780e918aaa5814c077f59daec" kindref="member">ECDH_STATUS_PUBLIC_KEY_LARGER_THAN_PRIME</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>One of the public key coordinates is larger the the curve&apos;s prime. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="675" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_d_h_8h_1a8590765ee63fff4d29504e25936108af" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t ECDH_cancelOperation</definition>
        <argsstring>(ECDH_Handle handle)</argsstring>
        <name>ECDH_cancelOperation</name>
        <param>
          <type><ref refid="_e_c_d_h_8h_1a4315ab9071ba852159e436a2c5684a51" kindref="member">ECDH_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <briefdescription>
<para>Cancels an ongoing ECDH operation. </para>        </briefdescription>
        <detaileddescription>
<para>Asynchronously cancels an ECDH operation. Only available when using ECDH_RETURN_BEHAVIOR_CALLBACK or ECDH_RETURN_BEHAVIOR_BLOCKING. The operation will terminate as though an error occured. The return status code of the operation will be ECDH_STATUS_CANCELED.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>Handle of the operation to cancel</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1aadb5927711e0215b36d2895573622a5f" kindref="member">ECDH_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_d_h_8h_1a833a693cf04fcd2e6983105f9ff137c5" kindref="member">ECDH_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was not canceled. There may be no operation to cancel. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h" line="690" column="1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>TI Driver for Elliptic Curve Diffie-Hellman key agreement scheme. </para>    </briefdescription>
    <detaileddescription>
<para><hruler/>
</para><para><simplesect kind="warning"><para>This is a beta API. It may change in future releases.</para></simplesect>
<anchor id="_e_c_d_h_8h_1ti_drivers_ECDH_Overview"/><heading level="1">Overview</heading>
</para><para>Elliptic Curve Diffie-Hellman (ECDH) is a key agreement scheme between two parties based on the Diffie-Hellman key exchange protocol.</para><para>It provides a means of generating a shared secret and derived symmetric key between the two parties over an insecure channel.</para><para>It does not provide authentication. As such, it does not guarantee that the party you are exchanging keys with is truly the party you wish to establish a secured channel with.</para><para>The two parties each generate a private key and a public key. The private key is a random integer in the interval [1, n - 1], where n is the order of a previously agreed upon curve. The public key is generated by multiplying the private key by the generator point of a previously agreed upon elliptic curve such as NISTP256 or Curve 25519. The public key is itself a point upon the elliptic curve. Each public key is then transmitted to the other party over a potentially insecure channel. The other party&apos;s public key is then multiplied with the private key, generating a shared secret. This shared secret is also a point on the curve. However, the entropy in the secret is not spread evenly throughout the shared secret. In order to generate one or more shared symmetric keys, the shared secret must be run through a key derivation function (KDF) that was previously agreed upon. Usually, only the X coordinate is processed in this way as it contains all the entropy of the shared secret and some curve implementations only provide the X coordinate. The key derivation function can take many forms, from simply hashing the X coordinate of the shared secret with SHA2 and truncating the result to generating multiple symmetric keys with HKDF, an HMAC based KDF.</para><para>Key derivation functions in the context of symmetric key generation after elliptic curve based key exchange differ from KDFs used to generate keys from passwords a user provides in a login. Those KDFs such as bcrypt purposefully add additional computation to increase a system&apos;s resistance against brute force or dictionary attacks.</para><para><anchor id="_e_c_d_h_8h_1ti_drivers_ECDH_Usage"/><heading level="1">Usage</heading>
</para><para><heading level="2">Before starting an ECDH operation</heading>
</para><para>Before starting an ECDH operation, the application must do the following:<itemizedlist>
<listitem><para>Call <ref refid="_e_c_d_h_8h_1aeafc9a67220447bca292685b6b2e7640" kindref="member">ECDH_init()</ref> to initialize the driver</para></listitem><listitem><para>Call <ref refid="_e_c_d_h_8h_1aba742374e7813cd416d26a1b86872bf4" kindref="member">ECDH_Params_init()</ref> to initialize the <ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref> to default values.</para></listitem><listitem><para>Modify the <ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref> as desired</para></listitem><listitem><para>Call <ref refid="_e_c_d_h_8h_1a4c10865a8a3c33937111b8a379e3783b" kindref="member">ECDH_open()</ref> to open an instance of the driver</para></listitem></itemizedlist>
</para><para><heading level="2">Generating your public-private key pair</heading>
</para><para>To generate a public-private key pair for an agreed upon curve, the application must do the following:<itemizedlist>
<listitem><para>Generate the keying material for the private key. This keying material must be an integer in the interval [1, n - 1], where n is the order of the curve. It should be stored in an array with the least significant byte of the integer hex representation stored in the lowest address of the array (little-endian). The array should be the same length as the curve parameters of the curve used. The driver validates private keys against the provided curve by default.</para></listitem><listitem><para>Initialize the private key CryptoKey. CryptoKeys are opaque datastructures and representations of keying material and its storage. Depending on how the keying material is stored (RAM or flash, key store, key blob), the CryptoKey must be initialized differently. The ECDH API can handle all types of CryptoKey. However, not all device-specific implementions support all types of CryptoKey. Devices without a key store will not support CryptoKeys with keying material stored in a key store for example. All devices support plaintext CryptoKeys.</para></listitem><listitem><para>Initialize a blank CryptoKey for the public key. The CryptoKey will keep track of where the keying material for the public key should be copied and how long it is. It should have twice the length of the private key.</para></listitem><listitem><para>Initialize the <ref refid="struct_e_c_d_h___operation_generate_public_key" kindref="compound">ECDH_OperationGeneratePublicKey</ref> struct and then populate it.</para></listitem><listitem><para>Call <ref refid="_e_c_d_h_8h_1af674c6e1f24af5212f0694ac033b3542" kindref="member">ECDH_generatePublicKey()</ref>. The generated keying material will be copied according the the CryptoKey passed in as the public key parameter. The CryptoKey will no longer be considered &apos;blank&apos; after the operation.</para></listitem></itemizedlist>
</para><para><heading level="2">Calculating a shared secret</heading>
</para><para>After trading public keys with the other party, the application should do the following to calculate the shared secret:<itemizedlist>
<listitem><para>Initialize a CryptoKey as public key with the keying material received from the other party.</para></listitem><listitem><para>Initialize a blank CryptoKey with the same size as the previously initialized public key.</para></listitem><listitem><para>Initialize the <ref refid="struct_e_c_d_h___operation_compute_shared_secret" kindref="compound">ECDH_OperationComputeSharedSecret</ref> struct and then populate it.</para></listitem><listitem><para>Call <ref refid="_e_c_d_h_8h_1aac7cce4647109da02f1f4f952697ae85" kindref="member">ECDH_computeSharedSecret()</ref>. The shared secret will be copied to a location according to the shared secret CryptoKey passed to the function call. The driver will validate the supplied public key and reject invalid ones.</para></listitem></itemizedlist>
</para><para><heading level="2">Creating one or more symmetric keys from the shared secret</heading>
</para><para>After calculating the shared secret between the application and the other party, the entropy in the shared secret must be evened out and stretched as needed. There are uncountable methods and algorithms to stretch an original seed entropy (the share secret) to generate symmetric keys.<itemizedlist>
<listitem><para>Run the X coordinate of the resulting entropy through a key derivation function (KDF)</para></listitem></itemizedlist>
</para><para><heading level="2">After a key exchange</heading>
</para><para>After the ECDH key exchange completes, the application should either start another operation or close the driver by calling <ref refid="_e_c_d_h_8h_1a47f6da8d23ef19680b27354e424dfcc1" kindref="member">ECDH_close()</ref></para><para><heading level="2">General usage</heading>
</para><para>The API expects elliptic curves as defined in <ref refid="_e_c_c_params_8h" kindref="compound">ti/drivers/cryptoutils/ecc/ECCParams.h</ref>. Several commonly used curves are provided. Check the device-specific ECDH documentation for curve type (short Weierstrass, Montgomery, Edwards) support for your device. ECDH support for a curve type on a device does not imply curve-type support for other ECC schemes.</para><para>Public keys and shared secrets are points on an elliptic curve. These points can be expressed in several ways. The most common one is in affine coordinates as an X,Y pair. This API uses points expressed in affine coordinates. The point is stored as a concatenated array of X followed by Y in a location described by its CryptoKey. Some implementations do not require or yield the Y coordinate for ECDH on certain curves. It is recommended that the full keying material buffer of twice the curve param length is used to facilitate code-reuse. Implementations that do not use the Y coordinate will zero-out the Y-coordinate whenever they write a point to the CryptoKey.</para><para>This API accepts and returns the keying material of public keys according to the following table:</para><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Curve Type </para></entry><entry thead="yes"><para>Keying Material Array </para></entry><entry thead="yes"><para>Array Length  </para></entry></row>
<row>
<entry thead="no"><para>Short Weierstrass </para></entry><entry thead="no"><para>[X, Y] </para></entry><entry thead="no"><para>2 * Curve Param Length </para></entry></row>
<row>
<entry thead="no"><para>Montgomery </para></entry><entry thead="no"><para>[X, Y] </para></entry><entry thead="no"><para>2 * Curve Param Length </para></entry></row>
<row>
<entry thead="no"><para>Edwards </para></entry><entry thead="no"><para>[X, Y] </para></entry><entry thead="no"><para>2 * Curve Param Length </para></entry></row>
</table>
<anchor id="_e_c_d_h_8h_1ti_drivers_ECDH_Synopsis"/><heading level="2">Synopsis</heading>
</para><para><anchor id="_e_c_d_h_8h_1ti_drivers_ECDH_Synopsis_Code"/><programlisting><codeline><highlight class="normal">//<sp/>Import<sp/>ECDH<sp/>Driver<sp/>definitions</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/ECDH.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECDH_init();</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Since<sp/>we<sp/>are<sp/>using<sp/>default<sp/>ECDH_Params,<sp/>we<sp/>just<sp/>pass<sp/>in<sp/>NULL<sp/>for<sp/>that<sp/>parameter.</highlight></codeline>
<codeline><highlight class="normal">ecdhHandle<sp/>=<sp/>ECDH_open(0,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Initialize<sp/>myPrivateKey<sp/>and<sp/>myPublicKey</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;myPrivateKey,<sp/>myPrivateKeyingMaterial,<sp/>sizeof(myPrivateKeyingMaterial));</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initBlankKey(&amp;myPublicKey,<sp/>myPublicKeyingMaterial,<sp/>sizeof(myPublicKeyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECDH_OperationGeneratePublicKey_init(&amp;operationGeneratePublicKey);</highlight></codeline>
<codeline><highlight class="normal">operationGeneratePublicKey.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationGeneratePublicKey.myPrivateKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateKey;</highlight></codeline>
<codeline><highlight class="normal">operationGeneratePublicKey.myPublicKey<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicKey;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>the<sp/>keying<sp/>material<sp/>for<sp/>myPublicKey<sp/>and<sp/>store<sp/>it<sp/>in<sp/>myPublicKeyingMaterial</highlight></codeline>
<codeline><highlight class="normal">operationResult<sp/>=<sp/>ECDH_generatePublicKey(ecdhHandle,<sp/>&amp;operationGeneratePublicKey);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Now<sp/>send<sp/>the<sp/>content<sp/>of<sp/>myPublicKeyingMaterial<sp/>to<sp/>theother<sp/>party,</highlight></codeline>
<codeline><highlight class="normal">//<sp/>receive<sp/>their<sp/>public<sp/>key,<sp/>and<sp/>copy<sp/>their<sp/>public<sp/>keying<sp/>material<sp/>to<sp/>theirPublicKeyingMaterial</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Initialise<sp/>their<sp/>public<sp/>CryptoKey<sp/>and<sp/>the<sp/>shared<sp/>secret<sp/>CryptoKey</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;theirPublicKey,<sp/>theirPublicKeyingMaterial,<sp/>sizeof(theirPublicKeyingMaterial));</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initBlankKey(&amp;sharedSecret,<sp/>sharedSecretKeyingMaterial,<sp/>sizeof(sharedSecretKeyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>ECC_NISTP256<sp/>struct<sp/>is<sp/>provided<sp/>in<sp/>ti/drivers/types/EccParams.h<sp/>and<sp/>the<sp/>corresponding<sp/>device-specific<sp/>implementation</highlight></codeline>
<codeline><highlight class="normal">ECDH_OperationComputeSharedSecret_init(&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateKey;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.theirPublicKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicKey;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.sharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;sharedSecret;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Compute<sp/>the<sp/>shared<sp/>secret<sp/>and<sp/>copy<sp/>it<sp/>to<sp/>sharedSecretKeyingMaterial</highlight></codeline>
<codeline><highlight class="normal">operationResult<sp/>=<sp/>ECDH_computeSharedSecret(ecdhHandle,<sp/>&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Close<sp/>the<sp/>driver</highlight></codeline>
<codeline><highlight class="normal">ECDH_close(ecdhHandle);</highlight></codeline>
</programlisting></para><para><anchor id="_e_c_d_h_8h_1ti_drivers_ECDH_Examples"/><heading level="1">Examples</heading>
</para><para><heading level="2">ECDH exchange with plaintext CryptoKeys</heading>
</para><para><programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/ECDH.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Our<sp/>private<sp/>key<sp/>is<sp/>0x0000000000000000000000000000000000000000000000000000000000000001</highlight></codeline>
<codeline><highlight class="normal">//<sp/>In<sp/>practice,<sp/>this<sp/>value<sp/>should<sp/>come<sp/>from<sp/>a<sp/>TRNG,<sp/>PRNG,<sp/>PUF,<sp/>or<sp/>device-specific<sp/>pre-seeded<sp/>key</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>myPrivateKeyingMaterial[32]<sp/>=<sp/>{0x01,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>myPublicKeyingMaterial[64]<sp/>=<sp/>{0};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>theirPublicKeyingMaterial[64]<sp/>=<sp/>{0};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>sharedSecretKeyingMaterial[64]<sp/>=<sp/>{0};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>symmetricKeyingMaterial[16]<sp/>=<sp/>{0};</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>myPrivateKey;</highlight></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>myPublicKey;</highlight></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>theirPublicKey;</highlight></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>sharedSecret;</highlight></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>symmetricKey;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECDH_Handle<sp/>ecdhHandle;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">int_fast16_t<sp/>operationResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECDH_OperationGeneratePublicKey<sp/>operationGeneratePublicKey;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Since<sp/>we<sp/>are<sp/>using<sp/>default<sp/>ECDH_Params,<sp/>we<sp/>just<sp/>pass<sp/>in<sp/>NULL<sp/>for<sp/>that<sp/>parameter.</highlight></codeline>
<codeline><highlight class="normal">ecdhHandle<sp/>=<sp/>ECDH_open(0,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(!ecdhHandle)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Initialize<sp/>myPrivateKey<sp/>and<sp/>myPublicKey</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;myPrivateKey,<sp/>myPrivateKeyingMaterial,<sp/>sizeof(myPrivateKeyingMaterial));</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initBlankKey(&amp;myPublicKey,<sp/>myPublicKeyingMaterial,<sp/>sizeof(myPublicKeyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECDH_OperationGeneratePublicKey_init(&amp;operationGeneratePublicKey);</highlight></codeline>
<codeline><highlight class="normal">operationGeneratePublicKey.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationGeneratePublicKey.myPrivateKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateKey;</highlight></codeline>
<codeline><highlight class="normal">operationGeneratePublicKey.myPublicKey<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicKey;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>the<sp/>keying<sp/>material<sp/>for<sp/>myPublicKey<sp/>and<sp/>store<sp/>it<sp/>in<sp/>myPublicKeyingMaterial</highlight></codeline>
<codeline><highlight class="normal">operationResult<sp/>=<sp/>ECDH_generatePublicKey(ecdhHandle,<sp/>&amp;operationGeneratePublicKey);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(operationResult<sp/>!=<sp/>ECDH_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Now<sp/>send<sp/>the<sp/>content<sp/>of<sp/>myPublicKeyingMaterial<sp/>to<sp/>theother<sp/>party,</highlight></codeline>
<codeline><highlight class="normal">//<sp/>receive<sp/>their<sp/>public<sp/>key,<sp/>and<sp/>copy<sp/>their<sp/>public<sp/>keying<sp/>material<sp/>to<sp/>theirPublicKeyingMaterial</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Initialise<sp/>their<sp/>public<sp/>CryptoKey<sp/>and<sp/>the<sp/>shared<sp/>secret<sp/>CryptoKey</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;theirPublicKey,<sp/>theirPublicKeyingMaterial,<sp/>sizeof(theirPublicKeyingMaterial));</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initBlankKey(&amp;sharedSecret,<sp/>sharedSecretKeyingMaterial,<sp/>sizeof(sharedSecretKeyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>ECC_NISTP256<sp/>struct<sp/>is<sp/>provided<sp/>in<sp/>ti/drivers/types/EccParams.h<sp/>and<sp/>the<sp/>corresponding<sp/>device-specific<sp/>implementation</highlight></codeline>
<codeline><highlight class="normal">ECDH_OperationComputeSharedSecret_init(&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateKey;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.theirPublicKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicKey;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.sharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;sharedSecret;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Compute<sp/>the<sp/>shared<sp/>secret<sp/>and<sp/>copy<sp/>it<sp/>to<sp/>sharedSecretKeyingMaterial</highlight></codeline>
<codeline><highlight class="normal">operationResult<sp/>=<sp/>ECDH_computeSharedSecret(ecdhHandle,<sp/>&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(operationResult<sp/>!=<sp/>ECDH_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initBlankKey(&amp;symmetricKey,<sp/>symmetricKeyingMaterial,<sp/>sizeof(symmetricKeyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Set<sp/>up<sp/>a<sp/>KDF<sp/>such<sp/>as<sp/>HKDF<sp/>and<sp/>open<sp/>the<sp/>requisite<sp/>cryptographic<sp/>primitive<sp/>driver<sp/>to<sp/>implement<sp/>it</highlight></codeline>
<codeline><highlight class="normal">//<sp/>HKDF<sp/>and<sp/>SHA2<sp/>were<sp/>chosen<sp/>as<sp/>an<sp/>example<sp/>and<sp/>may<sp/>not<sp/>be<sp/>available<sp/>directly</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>At<sp/>this<sp/>point,<sp/>you<sp/>and<sp/>the<sp/>other<sp/>party<sp/>have<sp/>both<sp/>created<sp/>the<sp/>content<sp/>within<sp/>symmetricKeyingMaterial<sp/>without</highlight></codeline>
<codeline><highlight class="normal">//<sp/>someone<sp/>else<sp/>listening<sp/>to<sp/>your<sp/>communication<sp/>channel<sp/>being<sp/>able<sp/>to<sp/>do<sp/>so</highlight></codeline>
</programlisting> </para>    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2017-2019,<sp/>Texas<sp/>Instruments<sp/>Incorporated</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>Texas<sp/>Instruments<sp/>Incorporated<sp/>nor<sp/>the<sp/>names<sp/>of</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>its<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>from<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS<sp/>&quot;AS<sp/>IS&quot;</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>COPYRIGHT<sp/>OWNER<sp/>OR</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,<sp/>SPECIAL,</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="comment">/*!****************************************************************************</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*<sp/>@file<sp/>ECDH.h</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*<sp/>@brief<sp/>TI<sp/>Driver<sp/>for<sp/>Elliptic<sp/>Curve<sp/>Diffie-Hellman<sp/>key<sp/>agreement<sp/>scheme.</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*<sp/>@warning<sp/>This<sp/>is<sp/>a<sp/>beta<sp/>API.<sp/>It<sp/>may<sp/>change<sp/>in<sp/>future<sp/>releases.</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECDH_Overview</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/>#<sp/>Overview<sp/>#</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/>*<sp/>Elliptic<sp/>Curve<sp/>Diffie-Hellman<sp/>(ECDH)<sp/>is<sp/>a<sp/>key<sp/>agreement<sp/>scheme<sp/>between</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/>*<sp/>two<sp/>parties<sp/>based<sp/>on<sp/>the<sp/>Diffie-Hellman<sp/>key<sp/>exchange<sp/>protocol.</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*<sp/>It<sp/>provides<sp/>a<sp/>means<sp/>of<sp/>generating<sp/>a<sp/>shared<sp/>secret<sp/>and<sp/>derived<sp/>symmetric<sp/>key</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*<sp/>between<sp/>the<sp/>two<sp/>parties<sp/>over<sp/>an<sp/>insecure<sp/>channel.</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>*<sp/>It<sp/>does<sp/>not<sp/>provide<sp/>authentication.<sp/>As<sp/>such,<sp/>it<sp/>does<sp/>not<sp/>guarantee<sp/>that<sp/>the</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/>*<sp/>party<sp/>you<sp/>are<sp/>exchanging<sp/>keys<sp/>with<sp/>is<sp/>truly<sp/>the<sp/>party<sp/>you<sp/>wish<sp/>to<sp/>establish<sp/>a</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/>secured<sp/>channel<sp/>with.</highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/>*<sp/>The<sp/>two<sp/>parties<sp/>each<sp/>generate<sp/>a<sp/>private<sp/>key<sp/>and<sp/>a<sp/>public<sp/>key.<sp/>The<sp/>private<sp/>key</highlight></codeline>
<codeline lineno="53"><highlight class="comment"><sp/>*<sp/>is<sp/>a<sp/>random<sp/>integer<sp/>in<sp/>the<sp/>interval<sp/>[1,<sp/>n<sp/>-<sp/>1],<sp/>where<sp/>n<sp/>is<sp/>the<sp/>order<sp/>of<sp/>a</highlight></codeline>
<codeline lineno="54"><highlight class="comment"><sp/>*<sp/>previously<sp/>agreed<sp/>upon<sp/>curve.<sp/>The<sp/>public<sp/>key<sp/>is<sp/>generated</highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/>*<sp/>by<sp/>multiplying<sp/>the<sp/>private<sp/>key<sp/>by<sp/>the<sp/>generator<sp/>point<sp/>of<sp/>a<sp/>previously<sp/>agreed</highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/>*<sp/>upon<sp/>elliptic<sp/>curve<sp/>such<sp/>as<sp/>NISTP256<sp/>or<sp/>Curve<sp/>25519.<sp/>The<sp/>public<sp/>key<sp/>is<sp/>itself</highlight></codeline>
<codeline lineno="57"><highlight class="comment"><sp/>*<sp/>a<sp/>point<sp/>upon<sp/>the<sp/>elliptic<sp/>curve.<sp/>Each<sp/>public<sp/>key<sp/>is<sp/>then<sp/>transmitted<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/>*<sp/>other<sp/>party<sp/>over<sp/>a<sp/>potentially<sp/>insecure<sp/>channel.<sp/>The<sp/>other<sp/>party&apos;s<sp/>public<sp/>key</highlight></codeline>
<codeline lineno="59"><highlight class="comment"><sp/>*<sp/>is<sp/>then<sp/>multiplied<sp/>with<sp/>the<sp/>private<sp/>key,<sp/>generating<sp/>a<sp/>shared<sp/>secret.<sp/>This</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/>*<sp/>shared<sp/>secret<sp/>is<sp/>also<sp/>a<sp/>point<sp/>on<sp/>the<sp/>curve.<sp/>However,<sp/>the<sp/>entropy<sp/>in<sp/>the<sp/>secret</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/>*<sp/>is<sp/>not<sp/>spread<sp/>evenly<sp/>throughout<sp/>the<sp/>shared<sp/>secret.<sp/>In<sp/>order<sp/>to<sp/>generate<sp/>one<sp/>or<sp/>more</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*<sp/>shared<sp/>symmetric<sp/>keys,<sp/>the<sp/>shared<sp/>secret<sp/>must<sp/>be<sp/>run<sp/>through<sp/>a<sp/>key<sp/>derivation</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/>*<sp/>function<sp/>(KDF)<sp/>that<sp/>was<sp/>previously<sp/>agreed<sp/>upon.<sp/>Usually,<sp/>only<sp/>the<sp/>X<sp/>coordinate</highlight></codeline>
<codeline lineno="64"><highlight class="comment"><sp/>*<sp/>is<sp/>processed<sp/>in<sp/>this<sp/>way<sp/>as<sp/>it<sp/>contains<sp/>all<sp/>the<sp/>entropy<sp/>of<sp/>the<sp/>shared<sp/>secret<sp/>and</highlight></codeline>
<codeline lineno="65"><highlight class="comment"><sp/>*<sp/>some<sp/>curve<sp/>implementations<sp/>only<sp/>provide<sp/>the<sp/>X<sp/>coordinate.<sp/>The<sp/>key<sp/>derivation<sp/>function</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/>*<sp/>can<sp/>take<sp/>many<sp/>forms,<sp/>from<sp/>simply<sp/>hashing<sp/>the<sp/>X<sp/>coordinate<sp/>of<sp/>the<sp/>shared<sp/>secret</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/>*<sp/>with<sp/>SHA2<sp/>and<sp/>truncating<sp/>the<sp/>result<sp/>to<sp/>generating<sp/>multiple<sp/>symmetric<sp/>keys<sp/>with</highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/>*<sp/>HKDF,<sp/>an<sp/>HMAC<sp/>based<sp/>KDF.</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="70"><highlight class="comment"><sp/>*<sp/>Key<sp/>derivation<sp/>functions<sp/>in<sp/>the<sp/>context<sp/>of<sp/>symmetric<sp/>key<sp/>generation<sp/>after</highlight></codeline>
<codeline lineno="71"><highlight class="comment"><sp/>*<sp/>elliptic<sp/>curve<sp/>based<sp/>key<sp/>exchange<sp/>differ<sp/>from<sp/>KDFs<sp/>used<sp/>to<sp/>generate<sp/>keys<sp/>from</highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/>*<sp/>passwords<sp/>a<sp/>user<sp/>provides<sp/>in<sp/>a<sp/>login.<sp/>Those<sp/>KDFs<sp/>such<sp/>as<sp/>bcrypt<sp/>purposefully</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/>*<sp/>add<sp/>additional<sp/>computation<sp/>to<sp/>increase<sp/>a<sp/>system&apos;s<sp/>resistance<sp/>against<sp/>brute</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*<sp/>force<sp/>or<sp/>dictionary<sp/>attacks.</highlight></codeline>
<codeline lineno="75"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="76"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECDH_Usage</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/>*<sp/>#<sp/>Usage<sp/>#</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*<sp/>##<sp/>Before<sp/>starting<sp/>an<sp/>ECDH<sp/>operation<sp/>#</highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/>*<sp/>Before<sp/>starting<sp/>an<sp/>ECDH<sp/>operation,<sp/>the<sp/>application<sp/>must<sp/>do<sp/>the<sp/>following:</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>ECDH_init()<sp/>to<sp/>initialize<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>ECDH_Params_init()<sp/>to<sp/>initialize<sp/>the<sp/>ECDH_Params<sp/>to<sp/>default<sp/>values.</highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Modify<sp/>the<sp/>ECDH_Params<sp/>as<sp/>desired</highlight></codeline>
<codeline lineno="85"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>ECDH_open()<sp/>to<sp/>open<sp/>an<sp/>instance<sp/>of<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/>*<sp/>##<sp/>Generating<sp/>your<sp/>public-private<sp/>key<sp/>pair<sp/>#</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/>*<sp/>To<sp/>generate<sp/>a<sp/>public-private<sp/>key<sp/>pair<sp/>for<sp/>an<sp/>agreed<sp/>upon<sp/>curve,<sp/>the<sp/>application</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/>*<sp/>must<sp/>do<sp/>the<sp/>following:</highlight></codeline>
<codeline lineno="90"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Generate<sp/>the<sp/>keying<sp/>material<sp/>for<sp/>the<sp/>private<sp/>key.<sp/>This<sp/>keying<sp/>material<sp/>must</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>an<sp/>integer<sp/>in<sp/>the<sp/>interval<sp/>[1,<sp/>n<sp/>-<sp/>1],<sp/>where<sp/>n<sp/>is<sp/>the<sp/>order<sp/>of<sp/>the<sp/>curve.</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>It<sp/>should<sp/>be<sp/>stored<sp/>in<sp/>an<sp/>array<sp/>with<sp/>the<sp/>least<sp/>significant<sp/>byte<sp/>of<sp/>the<sp/>integer</highlight></codeline>
<codeline lineno="93"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hex<sp/>representation<sp/>stored<sp/>in<sp/>the<sp/>lowest<sp/>address<sp/>of<sp/>the<sp/>array<sp/>(little-endian).</highlight></codeline>
<codeline lineno="94"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>array<sp/>should<sp/>be<sp/>the<sp/>same<sp/>length<sp/>as<sp/>the<sp/>curve<sp/>parameters<sp/>of<sp/>the<sp/>curve<sp/>used.</highlight></codeline>
<codeline lineno="95"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>driver<sp/>validates<sp/>private<sp/>keys<sp/>against<sp/>the<sp/>provided<sp/>curve<sp/>by<sp/>default.</highlight></codeline>
<codeline lineno="96"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>the<sp/>private<sp/>key<sp/>CryptoKey.<sp/>CryptoKeys<sp/>are<sp/>opaque<sp/>datastructures<sp/>and<sp/>representations</highlight></codeline>
<codeline lineno="97"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>keying<sp/>material<sp/>and<sp/>its<sp/>storage.<sp/>Depending<sp/>on<sp/>how<sp/>the<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="98"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>stored<sp/>(RAM<sp/>or<sp/>flash,<sp/>key<sp/>store,<sp/>key<sp/>blob),<sp/>the<sp/>CryptoKey<sp/>must<sp/>be</highlight></codeline>
<codeline lineno="99"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>initialized<sp/>differently.<sp/>The<sp/>ECDH<sp/>API<sp/>can<sp/>handle<sp/>all<sp/>types<sp/>of<sp/>CryptoKey.</highlight></codeline>
<codeline lineno="100"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>However,<sp/>not<sp/>all<sp/>device-specific<sp/>implementions<sp/>support<sp/>all<sp/>types<sp/>of<sp/>CryptoKey.</highlight></codeline>
<codeline lineno="101"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Devices<sp/>without<sp/>a<sp/>key<sp/>store<sp/>will<sp/>not<sp/>support<sp/>CryptoKeys<sp/>with<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="102"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stored<sp/>in<sp/>a<sp/>key<sp/>store<sp/>for<sp/>example.</highlight></codeline>
<codeline lineno="103"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>All<sp/>devices<sp/>support<sp/>plaintext<sp/>CryptoKeys.</highlight></codeline>
<codeline lineno="104"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>a<sp/>blank<sp/>CryptoKey<sp/>for<sp/>the<sp/>public<sp/>key.<sp/>The<sp/>CryptoKey<sp/>will<sp/>keep<sp/>track</highlight></codeline>
<codeline lineno="105"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>where<sp/>the<sp/>keying<sp/>material<sp/>for<sp/>the<sp/>public<sp/>key<sp/>should<sp/>be<sp/>copied<sp/>and<sp/>how</highlight></codeline>
<codeline lineno="106"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>long<sp/>it<sp/>is.<sp/>It<sp/>should<sp/>have<sp/>twice<sp/>the<sp/>length<sp/>of<sp/>the<sp/>private<sp/>key.</highlight></codeline>
<codeline lineno="107"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>the<sp/>ECDH_OperationGeneratePublicKey<sp/>struct<sp/>and<sp/>then<sp/>populate<sp/>it.</highlight></codeline>
<codeline lineno="108"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>ECDH_generatePublicKey().<sp/>The<sp/>generated<sp/>keying<sp/>material<sp/>will<sp/>be<sp/>copied</highlight></codeline>
<codeline lineno="109"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>according<sp/>the<sp/>the<sp/>CryptoKey<sp/>passed<sp/>in<sp/>as<sp/>the<sp/>public<sp/>key<sp/>parameter.<sp/>The<sp/>CryptoKey</highlight></codeline>
<codeline lineno="110"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>will<sp/>no<sp/>longer<sp/>be<sp/>considered<sp/>&apos;blank&apos;<sp/>after<sp/>the<sp/>operation.</highlight></codeline>
<codeline lineno="111"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="112"><highlight class="comment"><sp/>*<sp/>##<sp/>Calculating<sp/>a<sp/>shared<sp/>secret<sp/>#</highlight></codeline>
<codeline lineno="113"><highlight class="comment"><sp/>*<sp/>After<sp/>trading<sp/>public<sp/>keys<sp/>with<sp/>the<sp/>other<sp/>party,<sp/>the<sp/>application<sp/>should<sp/>do<sp/>the<sp/>following</highlight></codeline>
<codeline lineno="114"><highlight class="comment"><sp/>*<sp/>to<sp/>calculate<sp/>the<sp/>shared<sp/>secret:</highlight></codeline>
<codeline lineno="115"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>a<sp/>CryptoKey<sp/>as<sp/>public<sp/>key<sp/>with<sp/>the<sp/>keying<sp/>material<sp/>received<sp/>from<sp/>the<sp/>other</highlight></codeline>
<codeline lineno="116"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>party.</highlight></codeline>
<codeline lineno="117"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>a<sp/>blank<sp/>CryptoKey<sp/>with<sp/>the<sp/>same<sp/>size<sp/>as<sp/>the<sp/>previously<sp/>initialized</highlight></codeline>
<codeline lineno="118"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>public<sp/>key.</highlight></codeline>
<codeline lineno="119"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>the<sp/>ECDH_OperationComputeSharedSecret<sp/>struct<sp/>and<sp/>then<sp/>populate<sp/>it.</highlight></codeline>
<codeline lineno="120"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>ECDH_computeSharedSecret().<sp/>The<sp/>shared<sp/>secret<sp/>will<sp/>be<sp/>copied<sp/>to<sp/>a<sp/>location</highlight></codeline>
<codeline lineno="121"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>according<sp/>to<sp/>the<sp/>shared<sp/>secret<sp/>CryptoKey<sp/>passed<sp/>to<sp/>the<sp/>function<sp/>call.<sp/>The<sp/>driver</highlight></codeline>
<codeline lineno="122"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>will<sp/>validate<sp/>the<sp/>supplied<sp/>public<sp/>key<sp/>and<sp/>reject<sp/>invalid<sp/>ones.</highlight></codeline>
<codeline lineno="123"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="124"><highlight class="comment"><sp/>*<sp/>##<sp/>Creating<sp/>one<sp/>or<sp/>more<sp/>symmetric<sp/>keys<sp/>from<sp/>the<sp/>shared<sp/>secret<sp/>#</highlight></codeline>
<codeline lineno="125"><highlight class="comment"><sp/>*<sp/>After<sp/>calculating<sp/>the<sp/>shared<sp/>secret<sp/>between<sp/>the<sp/>application<sp/>and<sp/>the<sp/>other<sp/>party,</highlight></codeline>
<codeline lineno="126"><highlight class="comment"><sp/>*<sp/>the<sp/>entropy<sp/>in<sp/>the<sp/>shared<sp/>secret<sp/>must<sp/>be<sp/>evened<sp/>out<sp/>and<sp/>stretched<sp/>as<sp/>needed.<sp/>There<sp/>are</highlight></codeline>
<codeline lineno="127"><highlight class="comment"><sp/>*<sp/>uncountable<sp/>methods<sp/>and<sp/>algorithms<sp/>to<sp/>stretch<sp/>an<sp/>original<sp/>seed<sp/>entropy<sp/>(the<sp/>share<sp/>secret)</highlight></codeline>
<codeline lineno="128"><highlight class="comment"><sp/>*<sp/>to<sp/>generate<sp/>symmetric<sp/>keys.</highlight></codeline>
<codeline lineno="129"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Run<sp/>the<sp/>X<sp/>coordinate<sp/>of<sp/>the<sp/>resulting<sp/>entropy<sp/>through<sp/>a<sp/>key<sp/>derivation<sp/>function<sp/>(KDF)</highlight></codeline>
<codeline lineno="130"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="131"><highlight class="comment"><sp/>*<sp/>##<sp/>After<sp/>a<sp/>key<sp/>exchange<sp/>#</highlight></codeline>
<codeline lineno="132"><highlight class="comment"><sp/>*<sp/>After<sp/>the<sp/>ECDH<sp/>key<sp/>exchange<sp/>completes,<sp/>the<sp/>application<sp/>should<sp/>either<sp/>start<sp/>another<sp/>operation</highlight></codeline>
<codeline lineno="133"><highlight class="comment"><sp/>*<sp/>or<sp/>close<sp/>the<sp/>driver<sp/>by<sp/>calling<sp/>ECDH_close()</highlight></codeline>
<codeline lineno="134"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="135"><highlight class="comment"><sp/>*<sp/>##<sp/>General<sp/>usage<sp/>#</highlight></codeline>
<codeline lineno="136"><highlight class="comment"><sp/>*<sp/>The<sp/>API<sp/>expects<sp/>elliptic<sp/>curves<sp/>as<sp/>defined<sp/>in<sp/>ti/drivers/cryptoutils/ecc/ECCParams.h.</highlight></codeline>
<codeline lineno="137"><highlight class="comment"><sp/>*<sp/>Several<sp/>commonly<sp/>used<sp/>curves<sp/>are<sp/>provided.<sp/>Check<sp/>the<sp/>device-specific<sp/>ECDH<sp/>documentation</highlight></codeline>
<codeline lineno="138"><highlight class="comment"><sp/>*<sp/>for<sp/>curve<sp/>type<sp/>(short<sp/>Weierstrass,<sp/>Montgomery,<sp/>Edwards)<sp/>support<sp/>for<sp/>your<sp/>device.</highlight></codeline>
<codeline lineno="139"><highlight class="comment"><sp/>*<sp/>ECDH<sp/>support<sp/>for<sp/>a<sp/>curve<sp/>type<sp/>on<sp/>a<sp/>device<sp/>does<sp/>not<sp/>imply<sp/>curve-type<sp/>support<sp/>for</highlight></codeline>
<codeline lineno="140"><highlight class="comment"><sp/>*<sp/>other<sp/>ECC<sp/>schemes.</highlight></codeline>
<codeline lineno="141"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="142"><highlight class="comment"><sp/>*<sp/>Public<sp/>keys<sp/>and<sp/>shared<sp/>secrets<sp/>are<sp/>points<sp/>on<sp/>an<sp/>elliptic<sp/>curve.<sp/>These<sp/>points<sp/>can</highlight></codeline>
<codeline lineno="143"><highlight class="comment"><sp/>*<sp/>be<sp/>expressed<sp/>in<sp/>several<sp/>ways.<sp/>The<sp/>most<sp/>common<sp/>one<sp/>is<sp/>in<sp/>affine<sp/>coordinates<sp/>as<sp/>an</highlight></codeline>
<codeline lineno="144"><highlight class="comment"><sp/>*<sp/>X,Y<sp/>pair.</highlight></codeline>
<codeline lineno="145"><highlight class="comment"><sp/>*<sp/>This<sp/>API<sp/>uses<sp/>points<sp/>expressed<sp/>in<sp/>affine<sp/>coordinates.</highlight></codeline>
<codeline lineno="146"><highlight class="comment"><sp/>*<sp/>The<sp/>point<sp/>is<sp/>stored<sp/>as<sp/>a<sp/>concatenated<sp/>array<sp/>of<sp/>X<sp/>followed<sp/>by<sp/>Y<sp/>in<sp/>a<sp/>location</highlight></codeline>
<codeline lineno="147"><highlight class="comment"><sp/>*<sp/>described<sp/>by<sp/>its<sp/>CryptoKey.<sp/>Some<sp/>implementations<sp/>do<sp/>not<sp/>require<sp/>or<sp/>yield</highlight></codeline>
<codeline lineno="148"><highlight class="comment"><sp/>*<sp/>the<sp/>Y<sp/>coordinate<sp/>for<sp/>ECDH<sp/>on<sp/>certain<sp/>curves.<sp/>It<sp/>is<sp/>recommended<sp/>that<sp/>the<sp/>full</highlight></codeline>
<codeline lineno="149"><highlight class="comment"><sp/>*<sp/>keying<sp/>material<sp/>buffer<sp/>of<sp/>twice<sp/>the<sp/>curve<sp/>param<sp/>length<sp/>is<sp/>used<sp/>to<sp/>facilitate</highlight></codeline>
<codeline lineno="150"><highlight class="comment"><sp/>*<sp/>code-reuse.<sp/>Implementations<sp/>that<sp/>do<sp/>not<sp/>use<sp/>the<sp/>Y<sp/>coordinate<sp/>will<sp/>zero-out</highlight></codeline>
<codeline lineno="151"><highlight class="comment"><sp/>*<sp/>the<sp/>Y-coordinate<sp/>whenever<sp/>they<sp/>write<sp/>a<sp/>point<sp/>to<sp/>the<sp/>CryptoKey.</highlight></codeline>
<codeline lineno="152"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="153"><highlight class="comment"><sp/>*<sp/>This<sp/>API<sp/>accepts<sp/>and<sp/>returns<sp/>the<sp/>keying<sp/>material<sp/>of<sp/>public<sp/>keys<sp/>according</highlight></codeline>
<codeline lineno="154"><highlight class="comment"><sp/>*<sp/>to<sp/>the<sp/>following<sp/>table:</highlight></codeline>
<codeline lineno="155"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="156"><highlight class="comment"><sp/>*<sp/>|<sp/>Curve<sp/>Type<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>Keying<sp/>Material<sp/>Array<sp/>|<sp/>Array<sp/>Length<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="157"><highlight class="comment"><sp/>*<sp/>|--------------------|-----------------------|---------------------------|</highlight></codeline>
<codeline lineno="158"><highlight class="comment"><sp/>*<sp/>|<sp/>Short<sp/>Weierstrass<sp/><sp/>|<sp/>[X,<sp/>Y]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>2<sp/>*<sp/>Curve<sp/>Param<sp/>Length<sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="159"><highlight class="comment"><sp/>*<sp/>|<sp/>Montgomery<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>[X,<sp/>Y]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>2<sp/>*<sp/>Curve<sp/>Param<sp/>Length<sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="160"><highlight class="comment"><sp/>*<sp/>|<sp/>Edwards<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>[X,<sp/>Y]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>2<sp/>*<sp/>Curve<sp/>Param<sp/>Length<sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="161"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="162"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECDH_Synopsis</highlight></codeline>
<codeline lineno="163"><highlight class="comment"><sp/>*<sp/>##<sp/>Synopsis</highlight></codeline>
<codeline lineno="164"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECDH_Synopsis_Code</highlight></codeline>
<codeline lineno="165"><highlight class="comment"><sp/>*<sp/>@code</highlight></codeline>
<codeline lineno="166"><highlight class="comment"><sp/>*<sp/>//<sp/>Import<sp/>ECDH<sp/>Driver<sp/>definitions</highlight></codeline>
<codeline lineno="167"><highlight class="comment"><sp/>*<sp/>#include<sp/>&lt;ti/drivers/ECDH.h&gt;</highlight></codeline>
<codeline lineno="168"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="169"><highlight class="comment"><sp/>*<sp/>ECDH_init();</highlight></codeline>
<codeline lineno="170"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="171"><highlight class="comment"><sp/>*<sp/>//<sp/>Since<sp/>we<sp/>are<sp/>using<sp/>default<sp/>ECDH_Params,<sp/>we<sp/>just<sp/>pass<sp/>in<sp/>NULL<sp/>for<sp/>that<sp/>parameter.</highlight></codeline>
<codeline lineno="172"><highlight class="comment"><sp/>*<sp/>ecdhHandle<sp/>=<sp/>ECDH_open(0,<sp/>NULL);</highlight></codeline>
<codeline lineno="173"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="174"><highlight class="comment"><sp/>*<sp/>//<sp/>Initialize<sp/>myPrivateKey<sp/>and<sp/>myPublicKey</highlight></codeline>
<codeline lineno="175"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateKey,<sp/>myPrivateKeyingMaterial,<sp/>sizeof(myPrivateKeyingMaterial));</highlight></codeline>
<codeline lineno="176"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicKey,<sp/>myPublicKeyingMaterial,<sp/>sizeof(myPublicKeyingMaterial));</highlight></codeline>
<codeline lineno="177"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="178"><highlight class="comment"><sp/>*<sp/>ECDH_OperationGeneratePublicKey_init(&amp;operationGeneratePublicKey);</highlight></codeline>
<codeline lineno="179"><highlight class="comment"><sp/>*<sp/>operationGeneratePublicKey.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="180"><highlight class="comment"><sp/>*<sp/>operationGeneratePublicKey.myPrivateKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateKey;</highlight></codeline>
<codeline lineno="181"><highlight class="comment"><sp/>*<sp/>operationGeneratePublicKey.myPublicKey<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicKey;</highlight></codeline>
<codeline lineno="182"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="183"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>the<sp/>keying<sp/>material<sp/>for<sp/>myPublicKey<sp/>and<sp/>store<sp/>it<sp/>in<sp/>myPublicKeyingMaterial</highlight></codeline>
<codeline lineno="184"><highlight class="comment"><sp/>*<sp/>operationResult<sp/>=<sp/>ECDH_generatePublicKey(ecdhHandle,<sp/>&amp;operationGeneratePublicKey);</highlight></codeline>
<codeline lineno="185"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="186"><highlight class="comment"><sp/>*<sp/>//<sp/>Now<sp/>send<sp/>the<sp/>content<sp/>of<sp/>myPublicKeyingMaterial<sp/>to<sp/>theother<sp/>party,</highlight></codeline>
<codeline lineno="187"><highlight class="comment"><sp/>*<sp/>//<sp/>receive<sp/>their<sp/>public<sp/>key,<sp/>and<sp/>copy<sp/>their<sp/>public<sp/>keying<sp/>material<sp/>to<sp/>theirPublicKeyingMaterial</highlight></codeline>
<codeline lineno="188"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="189"><highlight class="comment"><sp/>*<sp/>//<sp/>Initialise<sp/>their<sp/>public<sp/>CryptoKey<sp/>and<sp/>the<sp/>shared<sp/>secret<sp/>CryptoKey</highlight></codeline>
<codeline lineno="190"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;theirPublicKey,<sp/>theirPublicKeyingMaterial,<sp/>sizeof(theirPublicKeyingMaterial));</highlight></codeline>
<codeline lineno="191"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;sharedSecret,<sp/>sharedSecretKeyingMaterial,<sp/>sizeof(sharedSecretKeyingMaterial));</highlight></codeline>
<codeline lineno="192"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="193"><highlight class="comment"><sp/>*<sp/>//<sp/>The<sp/>ECC_NISTP256<sp/>struct<sp/>is<sp/>provided<sp/>in<sp/>ti/drivers/types/EccParams.h<sp/>and<sp/>the<sp/>corresponding<sp/>device-specific<sp/>implementation</highlight></codeline>
<codeline lineno="194"><highlight class="comment"><sp/>*<sp/>ECDH_OperationComputeSharedSecret_init(&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline lineno="195"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="196"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateKey;</highlight></codeline>
<codeline lineno="197"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.theirPublicKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicKey;</highlight></codeline>
<codeline lineno="198"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.sharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;sharedSecret;</highlight></codeline>
<codeline lineno="199"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="200"><highlight class="comment"><sp/>*<sp/>//<sp/>Compute<sp/>the<sp/>shared<sp/>secret<sp/>and<sp/>copy<sp/>it<sp/>to<sp/>sharedSecretKeyingMaterial</highlight></codeline>
<codeline lineno="201"><highlight class="comment"><sp/>*<sp/>operationResult<sp/>=<sp/>ECDH_computeSharedSecret(ecdhHandle,<sp/>&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline lineno="202"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="203"><highlight class="comment"><sp/>*<sp/>//<sp/>Close<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="204"><highlight class="comment"><sp/>*<sp/>ECDH_close(ecdhHandle);</highlight></codeline>
<codeline lineno="205"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="206"><highlight class="comment"><sp/>*<sp/>@endcode</highlight></codeline>
<codeline lineno="207"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="208"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECDH_Examples</highlight></codeline>
<codeline lineno="209"><highlight class="comment"><sp/>*<sp/>#<sp/>Examples<sp/>#</highlight></codeline>
<codeline lineno="210"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="211"><highlight class="comment"><sp/>*<sp/>##<sp/>ECDH<sp/>exchange<sp/>with<sp/>plaintext<sp/>CryptoKeys<sp/>#</highlight></codeline>
<codeline lineno="212"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="213"><highlight class="comment"><sp/>*<sp/>@code</highlight></codeline>
<codeline lineno="214"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="215"><highlight class="comment"><sp/>*<sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="216"><highlight class="comment"><sp/>*<sp/>#include<sp/>&lt;ti/drivers/ECDH.h&gt;</highlight></codeline>
<codeline lineno="217"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="218"><highlight class="comment"><sp/>*<sp/>...</highlight></codeline>
<codeline lineno="219"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="220"><highlight class="comment"><sp/>*<sp/>//<sp/>Our<sp/>private<sp/>key<sp/>is<sp/>0x0000000000000000000000000000000000000000000000000000000000000001</highlight></codeline>
<codeline lineno="221"><highlight class="comment"><sp/>*<sp/>//<sp/>In<sp/>practice,<sp/>this<sp/>value<sp/>should<sp/>come<sp/>from<sp/>a<sp/>TRNG,<sp/>PRNG,<sp/>PUF,<sp/>or<sp/>device-specific<sp/>pre-seeded<sp/>key</highlight></codeline>
<codeline lineno="222"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPrivateKeyingMaterial[32]<sp/>=<sp/>{0x01,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,</highlight></codeline>
<codeline lineno="223"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,</highlight></codeline>
<codeline lineno="224"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,</highlight></codeline>
<codeline lineno="225"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00,<sp/>0x00};</highlight></codeline>
<codeline lineno="226"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPublicKeyingMaterial[64]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="227"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirPublicKeyingMaterial[64]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="228"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>sharedSecretKeyingMaterial[64]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="229"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>symmetricKeyingMaterial[16]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="230"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="231"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPrivateKey;</highlight></codeline>
<codeline lineno="232"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPublicKey;</highlight></codeline>
<codeline lineno="233"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>theirPublicKey;</highlight></codeline>
<codeline lineno="234"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>sharedSecret;</highlight></codeline>
<codeline lineno="235"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>symmetricKey;</highlight></codeline>
<codeline lineno="236"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="237"><highlight class="comment"><sp/>*<sp/>ECDH_Handle<sp/>ecdhHandle;</highlight></codeline>
<codeline lineno="238"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="239"><highlight class="comment"><sp/>*<sp/>int_fast16_t<sp/>operationResult;</highlight></codeline>
<codeline lineno="240"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="241"><highlight class="comment"><sp/>*<sp/>ECDH_OperationGeneratePublicKey<sp/>operationGeneratePublicKey;</highlight></codeline>
<codeline lineno="242"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="243"><highlight class="comment"><sp/>*<sp/>//<sp/>Since<sp/>we<sp/>are<sp/>using<sp/>default<sp/>ECDH_Params,<sp/>we<sp/>just<sp/>pass<sp/>in<sp/>NULL<sp/>for<sp/>that<sp/>parameter.</highlight></codeline>
<codeline lineno="244"><highlight class="comment"><sp/>*<sp/>ecdhHandle<sp/>=<sp/>ECDH_open(0,<sp/>NULL);</highlight></codeline>
<codeline lineno="245"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="246"><highlight class="comment"><sp/>*<sp/>if<sp/>(!ecdhHandle)<sp/>{</highlight></codeline>
<codeline lineno="247"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>//<sp/>Handle<sp/>error</highlight></codeline>
<codeline lineno="248"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="249"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="250"><highlight class="comment"><sp/>*<sp/>//<sp/>Initialize<sp/>myPrivateKey<sp/>and<sp/>myPublicKey</highlight></codeline>
<codeline lineno="251"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateKey,<sp/>myPrivateKeyingMaterial,<sp/>sizeof(myPrivateKeyingMaterial));</highlight></codeline>
<codeline lineno="252"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicKey,<sp/>myPublicKeyingMaterial,<sp/>sizeof(myPublicKeyingMaterial));</highlight></codeline>
<codeline lineno="253"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="254"><highlight class="comment"><sp/>*<sp/>ECDH_OperationGeneratePublicKey_init(&amp;operationGeneratePublicKey);</highlight></codeline>
<codeline lineno="255"><highlight class="comment"><sp/>*<sp/>operationGeneratePublicKey.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="256"><highlight class="comment"><sp/>*<sp/>operationGeneratePublicKey.myPrivateKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateKey;</highlight></codeline>
<codeline lineno="257"><highlight class="comment"><sp/>*<sp/>operationGeneratePublicKey.myPublicKey<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicKey;</highlight></codeline>
<codeline lineno="258"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="259"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>the<sp/>keying<sp/>material<sp/>for<sp/>myPublicKey<sp/>and<sp/>store<sp/>it<sp/>in<sp/>myPublicKeyingMaterial</highlight></codeline>
<codeline lineno="260"><highlight class="comment"><sp/>*<sp/>operationResult<sp/>=<sp/>ECDH_generatePublicKey(ecdhHandle,<sp/>&amp;operationGeneratePublicKey);</highlight></codeline>
<codeline lineno="261"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="262"><highlight class="comment"><sp/>*<sp/>if<sp/>(operationResult<sp/>!=<sp/>ECDH_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="263"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>//<sp/>Handle<sp/>error</highlight></codeline>
<codeline lineno="264"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="265"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="266"><highlight class="comment"><sp/>*<sp/>//<sp/>Now<sp/>send<sp/>the<sp/>content<sp/>of<sp/>myPublicKeyingMaterial<sp/>to<sp/>theother<sp/>party,</highlight></codeline>
<codeline lineno="267"><highlight class="comment"><sp/>*<sp/>//<sp/>receive<sp/>their<sp/>public<sp/>key,<sp/>and<sp/>copy<sp/>their<sp/>public<sp/>keying<sp/>material<sp/>to<sp/>theirPublicKeyingMaterial</highlight></codeline>
<codeline lineno="268"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="269"><highlight class="comment"><sp/>*<sp/>//<sp/>Initialise<sp/>their<sp/>public<sp/>CryptoKey<sp/>and<sp/>the<sp/>shared<sp/>secret<sp/>CryptoKey</highlight></codeline>
<codeline lineno="270"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;theirPublicKey,<sp/>theirPublicKeyingMaterial,<sp/>sizeof(theirPublicKeyingMaterial));</highlight></codeline>
<codeline lineno="271"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;sharedSecret,<sp/>sharedSecretKeyingMaterial,<sp/>sizeof(sharedSecretKeyingMaterial));</highlight></codeline>
<codeline lineno="272"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="273"><highlight class="comment"><sp/>*<sp/>//<sp/>The<sp/>ECC_NISTP256<sp/>struct<sp/>is<sp/>provided<sp/>in<sp/>ti/drivers/types/EccParams.h<sp/>and<sp/>the<sp/>corresponding<sp/>device-specific<sp/>implementation</highlight></codeline>
<codeline lineno="274"><highlight class="comment"><sp/>*<sp/>ECDH_OperationComputeSharedSecret_init(&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline lineno="275"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="276"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateKey;</highlight></codeline>
<codeline lineno="277"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.theirPublicKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicKey;</highlight></codeline>
<codeline lineno="278"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.sharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;sharedSecret;</highlight></codeline>
<codeline lineno="279"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="280"><highlight class="comment"><sp/>*<sp/>//<sp/>Compute<sp/>the<sp/>shared<sp/>secret<sp/>and<sp/>copy<sp/>it<sp/>to<sp/>sharedSecretKeyingMaterial</highlight></codeline>
<codeline lineno="281"><highlight class="comment"><sp/>*<sp/>operationResult<sp/>=<sp/>ECDH_computeSharedSecret(ecdhHandle,<sp/>&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="283"><highlight class="comment"><sp/>*<sp/>if<sp/>(operationResult<sp/>!=<sp/>ECDH_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>//<sp/>Handle<sp/>error</highlight></codeline>
<codeline lineno="285"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="286"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="287"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;symmetricKey,<sp/>symmetricKeyingMaterial,<sp/>sizeof(symmetricKeyingMaterial));</highlight></codeline>
<codeline lineno="288"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="289"><highlight class="comment"><sp/>*<sp/>//<sp/>Set<sp/>up<sp/>a<sp/>KDF<sp/>such<sp/>as<sp/>HKDF<sp/>and<sp/>open<sp/>the<sp/>requisite<sp/>cryptographic<sp/>primitive<sp/>driver<sp/>to<sp/>implement<sp/>it</highlight></codeline>
<codeline lineno="290"><highlight class="comment"><sp/>*<sp/>//<sp/>HKDF<sp/>and<sp/>SHA2<sp/>were<sp/>chosen<sp/>as<sp/>an<sp/>example<sp/>and<sp/>may<sp/>not<sp/>be<sp/>available<sp/>directly</highlight></codeline>
<codeline lineno="291"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="292"><highlight class="comment"><sp/>*<sp/>//<sp/>At<sp/>this<sp/>point,<sp/>you<sp/>and<sp/>the<sp/>other<sp/>party<sp/>have<sp/>both<sp/>created<sp/>the<sp/>content<sp/>within<sp/>symmetricKeyingMaterial<sp/>without</highlight></codeline>
<codeline lineno="293"><highlight class="comment"><sp/>*<sp/>//<sp/>someone<sp/>else<sp/>listening<sp/>to<sp/>your<sp/>communication<sp/>channel<sp/>being<sp/>able<sp/>to<sp/>do<sp/>so</highlight></codeline>
<codeline lineno="294"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="295"><highlight class="comment"><sp/>*<sp/>@endcode</highlight></codeline>
<codeline lineno="296"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="297"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="298"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>ti_drivers_ECDH__include</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ti_drivers_ECDH__include</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdbool.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="_crypto_key_8h" kindref="compound">ti/drivers/cryptoutils/cryptokey/CryptoKey.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="_e_c_c_params_8h" kindref="compound">ti/drivers/cryptoutils/ecc/ECCParams.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight></codeline>
<codeline lineno="327" refid="_e_c_d_h_8h_1a00dbed059c824024835da32a82143cf9" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_RESERVED<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(-32)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="335" refid="_e_c_d_h_8h_1aadb5927711e0215b36d2895573622a5f" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_SUCCESS<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight></codeline>
<codeline lineno="343" refid="_e_c_d_h_8h_1a833a693cf04fcd2e6983105f9ff137c5" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_ERROR<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(-1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="353" refid="_e_c_d_h_8h_1ab70467d8fc82bab4e8e709273d6cd322" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_RESOURCE_UNAVAILABLE<sp/>(-2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="361" refid="_e_c_d_h_8h_1ad1255d673e521a12585d034ab228af3f" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_POINT_AT_INFINITY<sp/>(-3)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="369" refid="_e_c_d_h_8h_1a9858e344c1e0603f86645ae4928a3eca" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_PRIVATE_KEY_LARGER_EQUAL_ORDER<sp/>(-4)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight></codeline>
<codeline lineno="377" refid="_e_c_d_h_8h_1ad4a3781705d2a5cf7850187828a27a58" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_PRIVATE_KEY_ZERO<sp/>(-5)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight></codeline>
<codeline lineno="385" refid="_e_c_d_h_8h_1aaf391c2c59fbf91364c2664b38af7bbe" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_PUBLIC_KEY_NOT_ON_CURVE<sp/>(-6)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="394" refid="_e_c_d_h_8h_1a0765420780e918aaa5814c077f59daec" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_PUBLIC_KEY_LARGER_THAN_PRIME<sp/>(-7)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="399" refid="_e_c_d_h_8h_1aabdb2de28f3e3acd88275dc0cdc573c0" refkind="member"><highlight class="preprocessor">#define<sp/>ECDH_STATUS_CANCELED<sp/>(-8)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"></highlight></codeline>
<codeline lineno="404" refid="_e_c_d_h_8h_1a4315ab9071ba852159e436a2c5684a51" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="struct_e_c_d_h___config" kindref="compound">ECDH_Config</ref><sp/><sp/>*<ref refid="_e_c_d_h_8h_1a4315ab9071ba852159e436a2c5684a51" kindref="member">ECDH_Handle</ref>;</highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight></codeline>
<codeline lineno="427" refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="428" refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670aab484909ed8c542b06511a66cc52ef18" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670aab484909ed8c542b06511a66cc52ef18" kindref="member">ECDH_RETURN_BEHAVIOR_CALLBACK</ref><sp/>=<sp/>1,<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="434" refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670ad76afb7626a0e43453bd8d7713eae59a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670ad76afb7626a0e43453bd8d7713eae59a" kindref="member">ECDH_RETURN_BEHAVIOR_BLOCKING</ref><sp/>=<sp/>2,<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="438" refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670a91e4b64cb2e16e67d8d3085efb31cc52" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670a91e4b64cb2e16e67d8d3085efb31cc52" kindref="member">ECDH_RETURN_BEHAVIOR_POLLING</ref><sp/><sp/>=<sp/>4,<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="442"><highlight class="normal">}<sp/><ref refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670" kindref="member">ECDH_ReturnBehavior</ref>;</highlight></codeline>
<codeline lineno="443"><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"></highlight></codeline>
<codeline lineno="456" refid="struct_e_c_d_h___config" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="struct_e_c_d_h___config" kindref="compound">ECDH_Config</ref><sp/>{</highlight></codeline>
<codeline lineno="458" refid="struct_e_c_d_h___config_1a0ecde7b79dbd50ce9fdf6c0ced2461ec" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="struct_e_c_d_h___config_1a0ecde7b79dbd50ce9fdf6c0ced2461ec" kindref="member">object</ref>;</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="461" refid="struct_e_c_d_h___config_1a5c9b606d45514f256255d4775cf3b514" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*<ref refid="struct_e_c_d_h___config_1a5c9b606d45514f256255d4775cf3b514" kindref="member">hwAttrs</ref>;</highlight></codeline>
<codeline lineno="462"><highlight class="normal">}<sp/><ref refid="_e_c_d_h_8h_1ae9a844cbf00537e5b1fd8dfa577a82df" kindref="member">ECDH_Config</ref>;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"></highlight></codeline>
<codeline lineno="467" refid="struct_e_c_d_h___operation_generate_public_key" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="468" refid="struct_e_c_d_h___operation_generate_public_key_1a294f8f0057a47509156520d7deda3b80" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_c_params___curve_params__" kindref="compound">ECCParams_CurveParams</ref><sp/><sp/><sp/><sp/><sp/>*<ref refid="struct_e_c_d_h___operation_generate_public_key_1a294f8f0057a47509156520d7deda3b80" kindref="member">curve</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="469" refid="struct_e_c_d_h___operation_generate_public_key_1a0bafde21f7129cc94cf7dd5af230b80b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key__" kindref="compound">CryptoKey</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="struct_e_c_d_h___operation_generate_public_key_1a0bafde21f7129cc94cf7dd5af230b80b" kindref="member">myPrivateKey</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="472" refid="struct_e_c_d_h___operation_generate_public_key_1a007ad6802f1edd96410cd1acfb6a5000" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key__" kindref="compound">CryptoKey</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="struct_e_c_d_h___operation_generate_public_key_1a007ad6802f1edd96410cd1acfb6a5000" kindref="member">myPublicKey</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="475"><highlight class="normal">}<sp/><ref refid="struct_e_c_d_h___operation_generate_public_key" kindref="compound">ECDH_OperationGeneratePublicKey</ref>;</highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight></codeline>
<codeline lineno="480" refid="struct_e_c_d_h___operation_compute_shared_secret" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="481" refid="struct_e_c_d_h___operation_compute_shared_secret_1a48ec0ce4a2973bfee8b4a402e3f7c764" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_c_params___curve_params__" kindref="compound">ECCParams_CurveParams</ref><sp/><sp/><sp/><sp/><sp/>*<ref refid="struct_e_c_d_h___operation_compute_shared_secret_1a48ec0ce4a2973bfee8b4a402e3f7c764" kindref="member">curve</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="484" refid="struct_e_c_d_h___operation_compute_shared_secret_1a52a819338fa7c1fc28af71a7da788295" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key__" kindref="compound">CryptoKey</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="struct_e_c_d_h___operation_compute_shared_secret_1a52a819338fa7c1fc28af71a7da788295" kindref="member">myPrivateKey</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="487" refid="struct_e_c_d_h___operation_compute_shared_secret_1a6540f4e6832e4af2c59e37e1f88a0184" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key__" kindref="compound">CryptoKey</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="struct_e_c_d_h___operation_compute_shared_secret_1a6540f4e6832e4af2c59e37e1f88a0184" kindref="member">theirPublicKey</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="490" refid="struct_e_c_d_h___operation_compute_shared_secret_1a245268db012d1faa33c350c2166a63cf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key__" kindref="compound">CryptoKey</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="struct_e_c_d_h___operation_compute_shared_secret_1a245268db012d1faa33c350c2166a63cf" kindref="member">sharedSecret</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="493"><highlight class="normal">}<sp/><ref refid="struct_e_c_d_h___operation_compute_shared_secret" kindref="compound">ECDH_OperationComputeSharedSecret</ref>;</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="498" refid="union_e_c_d_h___operation" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">union<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="499" refid="union_e_c_d_h___operation_1a8ea2131537f172ed34e83779420dc4b4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_e_c_d_h___operation_generate_public_key" kindref="compound">ECDH_OperationGeneratePublicKey</ref><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="union_e_c_d_h___operation_1a8ea2131537f172ed34e83779420dc4b4" kindref="member">generatePublicKey</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="500" refid="union_e_c_d_h___operation_1a8a20982b0df1ae92824e6d2b1726506e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_e_c_d_h___operation_compute_shared_secret" kindref="compound">ECDH_OperationComputeSharedSecret</ref><sp/><sp/><sp/><sp/>*<ref refid="union_e_c_d_h___operation_1a8a20982b0df1ae92824e6d2b1726506e" kindref="member">computeSharedSecret</ref>;<sp/><sp/></highlight></codeline>
<codeline lineno="501"><highlight class="normal">}<sp/><ref refid="union_e_c_d_h___operation" kindref="compound">ECDH_Operation</ref>;</highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="506" refid="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="507" refid="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490a62570c7af35bd230669defb259782d16" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490a62570c7af35bd230669defb259782d16" kindref="member">ECDH_OPERATION_TYPE_GENERATE_PUBLIC_KEY</ref><sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="508" refid="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490a5cd7dd7ccef7e1a2cda0dda6b6a309e5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490a5cd7dd7ccef7e1a2cda0dda6b6a309e5" kindref="member">ECDH_OPERATION_TYPE_COMPUTE_SHARED_SECRET</ref><sp/>=<sp/>2,</highlight></codeline>
<codeline lineno="509"><highlight class="normal">}<sp/><ref refid="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490" kindref="member">ECDH_OperationType</ref>;</highlight></codeline>
<codeline lineno="510"><highlight class="normal"></highlight></codeline>
<codeline lineno="529" refid="_e_c_d_h_8h_1a978c9e16d670371e7c0c50793fc4ec04" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/>void<sp/>(*<ref refid="_e_c_d_h_8h_1a978c9e16d670371e7c0c50793fc4ec04" kindref="member">ECDH_CallbackFxn</ref>)<sp/>(ECDH_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnStatus,</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="union_e_c_d_h___operation" kindref="compound">ECDH_Operation</ref><sp/>operation,</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_e_c_d_h_8h_1a99b8a8bbad4e932870174c38dec46490" kindref="member">ECDH_OperationType</ref><sp/>operationType);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"></highlight></codeline>
<codeline lineno="542" refid="struct_e_c_d_h___params" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="543" refid="struct_e_c_d_h___params_1a142f454a2576024594b48c531af03825" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_d_h_8h_1a95326e8fc727d9426a57cf4a6bb2f670" kindref="member">ECDH_ReturnBehavior</ref><sp/><sp/><sp/><sp/><sp/><ref refid="struct_e_c_d_h___params_1a142f454a2576024594b48c531af03825" kindref="member">returnBehavior</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="544" refid="struct_e_c_d_h___params_1ae923af750bcdcdd96fb5c05a73a97d1a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_d_h_8h_1a978c9e16d670371e7c0c50793fc4ec04" kindref="member">ECDH_CallbackFxn</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_e_c_d_h___params_1ae923af750bcdcdd96fb5c05a73a97d1a" kindref="member">callbackFxn</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="545" refid="struct_e_c_d_h___params_1a1fdb4c02265b463d2d0000c22fc31bb2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_e_c_d_h___params_1a1fdb4c02265b463d2d0000c22fc31bb2" kindref="member">timeout</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="546" refid="struct_e_c_d_h___params_1ae4ade9bf8a1bb5dbfa32ef0dd16f691e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="struct_e_c_d_h___params_1ae4ade9bf8a1bb5dbfa32ef0dd16f691e" kindref="member">custom</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="549"><highlight class="normal">}<sp/><ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref>;</highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref><sp/><ref refid="_e_c_d_h_8h_1ad97202536e7a3ea20529969825b5c389" kindref="member">ECDH_defaultParams</ref>;</highlight></codeline>
<codeline lineno="557"><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_d_h_8h_1aeafc9a67220447bca292685b6b2e7640" kindref="member">ECDH_init</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight></codeline>
<codeline lineno="580"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_d_h_8h_1aba742374e7813cd416d26a1b86872bf4" kindref="member">ECDH_Params_init</ref>(<ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref><sp/>*params);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal">ECDH_Handle<sp/><ref refid="_e_c_d_h_8h_1a4c10865a8a3c33937111b8a379e3783b" kindref="member">ECDH_open</ref>(uint_least8_t<sp/>index,<sp/><ref refid="struct_e_c_d_h___params" kindref="compound">ECDH_Params</ref><sp/>*params);</highlight></codeline>
<codeline lineno="600"><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_d_h_8h_1a47f6da8d23ef19680b27354e424dfcc1" kindref="member">ECDH_close</ref>(ECDH_Handle<sp/>handle);</highlight></codeline>
<codeline lineno="611"><highlight class="normal"></highlight></codeline>
<codeline lineno="620"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_d_h_8h_1a3828b70f1353f25ed32ce4daff66b5be" kindref="member">ECDH_OperationGeneratePublicKey_init</ref>(<ref refid="struct_e_c_d_h___operation_generate_public_key" kindref="compound">ECDH_OperationGeneratePublicKey</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_d_h_8h_1ad2eb16f459a7dad3cf51db76c74400bb" kindref="member">ECDH_OperationComputeSharedSecret_init</ref>(<ref refid="struct_e_c_d_h___operation_compute_shared_secret" kindref="compound">ECDH_OperationComputeSharedSecret</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="631"><highlight class="normal"></highlight></codeline>
<codeline lineno="654"><highlight class="normal">int_fast16_t<sp/><ref refid="_e_c_d_h_8h_1af674c6e1f24af5212f0694ac033b3542" kindref="member">ECDH_generatePublicKey</ref>(ECDH_Handle<sp/>handle,<sp/><ref refid="struct_e_c_d_h___operation_generate_public_key" kindref="compound">ECDH_OperationGeneratePublicKey</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight></codeline>
<codeline lineno="675"><highlight class="normal">int_fast16_t<sp/><ref refid="_e_c_d_h_8h_1aac7cce4647109da02f1f4f952697ae85" kindref="member">ECDH_computeSharedSecret</ref>(ECDH_Handle<sp/>handle,<sp/><ref refid="struct_e_c_d_h___operation_compute_shared_secret" kindref="compound">ECDH_OperationComputeSharedSecret</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="676"><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal">int_fast16_t<sp/><ref refid="_e_c_d_h_8h_1a8590765ee63fff4d29504e25936108af" kindref="member">ECDH_cancelOperation</ref>(ECDH_Handle<sp/>handle);</highlight></codeline>
<codeline lineno="691"><highlight class="normal"></highlight></codeline>
<codeline lineno="692"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal">}</highlight></codeline>
<codeline lineno="694"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"></highlight></codeline>
<codeline lineno="696"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>ti_drivers_ECDH__include<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="exports/tidrivers_cc13xx_cc26xx/source/ti/drivers/ECDH.h"/>
  </compounddef>
</doxygen>
