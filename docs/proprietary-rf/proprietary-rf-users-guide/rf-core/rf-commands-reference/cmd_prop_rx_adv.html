

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CMD_PROP_RX_ADV &mdash; 
SimpleLink™ CC2640R2 SDK
Proprietary RF User&#39;s Guide
 2.70.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Terms and acronyms" href="../../proprietary-rf-guide/glossary-cc2640.html" />
    <link rel="prev" title="CMD_PROP_CS" href="cmd_prop_cs.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug rf-core rf-commands-reference cmd_prop_rx_adv";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav">
   <!---- extra body elements for TI beyond RTD Sphinx Theme --->
<div class="DocSite-globalNav tiNav">
    <ul>
    </ul>
</div>

<a class="DocSite-nav" href="https://www.ti.com" style="padding-bottom: 85px;">
  <img class="DocSiteNav-logo"
    src="../../_static/img/ti_logo.png"
    alt="TI Logo">
  <div class="DocSiteNav-title"></div>
</a> 
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../proprietary-rf-guide/index-cc2640.html" class="icon icon-home" alt="Documentation Home"> 
SimpleLink™ CC2640R2 SDK
Proprietary RF User's Guide

          

          
          </a>

          
            
            
              <div class="version">
                2.70.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/quickstart-cc2640.html">Proprietary RF Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/index-platform-cc2640.html">The SimpleLink CC2640R2 SDK Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/examples-cc2640.html">Examples User’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/custom-hardware.html">Custom hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/tirtos-index.html">TI-RTOS (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/nortos-index.html">noRTOS Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/rf-core-index.html">RF Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/proprietary-rf-index-cc2640.html">Proprietary Physical Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/easylink-index.html">EasyLink Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cc2640/oad-easylink/oad.html">Over the Air Download (OAD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/migration-cc2640.html">Migration Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../proprietary-rf-guide/reference-cc2640.html">API References</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../easylink/easylink-api-reference-cc2640.html">EasyLink API Reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../rf-commands-reference.html">RF commands reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../rf-commands-reference.html#direct-commands">Direct commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rf-commands-reference.html#immediate-commands">Immediate commands</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../rf-commands-reference.html#radio-operation-commands">Radio operation commands</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="cmd_prop_cs.html">CMD_PROP_CS</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">CMD_PROP_RX_ADV</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../proprietary-rf-guide/glossary-cc2640.html">Terms and acronyms</a></li>
</ul>

            
          
          <!-- extra nav elements for TI beyond RTD Sphinx Theme --->
<div id="sideBanner">
    <br/>
    <br/><br/><br/>
</div>
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../proprietary-rf-guide/index-cc2640.html">
SimpleLink™ CC2640R2 SDK
Proprietary RF User's Guide
</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../proprietary-rf-guide/index-cc2640.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../proprietary-rf-guide/reference-cc2640.html">API References</a> &raquo;</li>
        
          <li><a href="../rf-commands-reference.html">RF commands reference</a> &raquo;</li>
        
      <li>CMD_PROP_RX_ADV</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cmd-prop-rx-adv">
<h1><span class="target" id="index-0"></span>CMD_PROP_RX_ADV<a class="headerlink" href="#cmd-prop-rx-adv" title="Permalink to this headline">¶</a></h1>
<div class="section" id="cmd-prop-rx-vs-cmd-prop-rx-adv">
<h2>cmd_prop_rx vs cmd_prop_rx_adv<a class="headerlink" href="#cmd-prop-rx-vs-cmd-prop-rx-adv" title="Permalink to this headline">¶</a></h2>
<p>The main differences between the packet format supported by the CMD_PROP_RX and the CMD_PROP_RX_ADV
commands are the Header field and the Address field.</p>
<div class="figure align-center" id="rx-adv-differences">
<span id="fig-cmd-prop-rx-adv-differences"></span><img alt="../../_images/fig_cmd_prop_rx_adv_diff.jpg" src="../../_images/fig_cmd_prop_rx_adv_diff.jpg" />
</div>
<p>The below table shows the difference between the cmd_prop_rx and cmd_prop_rx_adv commands:</p>
<table border="1" class="docutils" id="adv-difference-table">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">CMD_PROP_RX</th>
<th class="head">CMD_PROP_RX_ADV</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>RF_cmdPropRx.commandNo = 0x3802,</td>
<td>RF_cmdPropRxAdv.commandNo = 0x3804,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.status = 0x0000,</td>
<td>RF_cmdPropRxAdv.status = 0x0000,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.pNextOp = 0,</td>
<td>RF_cmdPropRxAdv.pNextOp = 0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.startTime = 0x00000000,</td>
<td>RF_cmdPropRxAdv.startTime = 0x00000000,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.startTrigger.triggerType = 0x0,</td>
<td>RF_cmdPropRxAdv.startTrigger.triggerType = 0x0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.startTrigger.bEnaCmd = 0x0,</td>
<td>RF_cmdPropRxAdv.startTrigger.bEnaCmd = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.startTrigger.triggerNo = 0x0,</td>
<td>RF_cmdPropRxAdv.startTrigger.triggerNo = 0x0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.startTrigger.pastTrig = 0x0,</td>
<td>RF_cmdPropRxAdv.startTrigger.pastTrig = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.condition.rule = 0x1,</td>
<td>RF_cmdPropRxAdv.condition.rule = 0x1,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.condition.nSkip = 0x0,</td>
<td>RF_cmdPropRxAdv.condition.nSkip = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.pktConf.bFsOff = 0x0,</td>
<td>RF_cmdPropRxAdv.pktConf.bFsOff = 0x0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.pktConf.bRepeatOk = 0x0,</td>
<td>RF_cmdPropRxAdv.pktConf.bRepeatOk = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.pktConf.bRepeatNok = 0x0,</td>
<td>RF_cmdPropRxAdv.pktConf.bRepeatNok = 0x0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.pktConf.bUseCrc = 0x1,</td>
<td>RF_cmdPropRxAdv.pktConf.bUseCrc = 0x1,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.pktConf.bVarLen = 0x1,</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.pktConf.bChkAddress = 0x0,</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRxAdv.pktConf.bCrcIncSw = 0x0,</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRxAdv.pktConf.bCrcIncHdr = 0x1,</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.pktConf.endType = 0x0,</td>
<td>RF_cmdPropRxAdv.pktConf.endType = 0x0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.pktConf.filterOp = 0x0,</td>
<td>RF_cmdPropRxAdv.pktConf.filterOp = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.rxConf.bAutoFlushIgnored = 0x0,</td>
<td>RF_cmdPropRxAdv.rxConf.bAutoFlushIgnored = 0x0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.rxConf.bAutoFlushCrcErr = 0x0,</td>
<td>RF_cmdPropRxAdv.rxConf.bAutoFlushCrcErr = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.rxConf.bIncludeHdr = 0x1,</td>
<td>RF_cmdPropRxAdv.rxConf.bIncludeHdr = 0x1,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.rxConf.bIncludeCrc = 0x0,</td>
<td>RF_cmdPropRxAdv.rxConf.bIncludeCrc = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.rxConf.bAppendRssi = 0x0,</td>
<td>RF_cmdPropRxAdv.rxConf.bAppendRssi = 0x0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.rxConf.bAppendTimestamp = 0x0,</td>
<td>RF_cmdPropRxAdv.rxConf.bAppendTimestamp = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.rxConf.bAppendStatus = 0x1,</td>
<td>RF_cmdPropRxAdv.rxConf.bAppendStatus = 0x0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.syncWord = 0x930B51DE,</td>
<td>RF_cmdPropRxAdv.syncWord0 = 0x930B51DE,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRxAdv.syncWord1 = 0x00000000,</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.maxPktLen = 0xFF,</td>
<td>RF_cmdPropRxAdv.maxPktLen = 0x00FF,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRxAdv.hdrConf.numHdrBits = 0x8,</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRxAdv.hdrConf.lenPos = 0x0,</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRxAdv.hdrConf.numLenBits = 0x8,</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRxAdv.addrConf.addrType = 0x0,</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRxAdv.addrConf.addrSize = 0x0,</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRxAdv.addrConf.addrPos = 0x0,</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRxAdv.addrConf.numAddr = 0x0,</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.address0 = 0xAA,</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.address1 = 0xBB,</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRxAdv.lenOffset = 0x00,</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.endTrigger.triggerType = 0x1,</td>
<td>RF_cmdPropRxAdv.endTrigger.triggerType = 0x1,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.endTrigger.bEnaCmd = 0x0,</td>
<td>RF_cmdPropRxAdv.endTrigger.bEnaCmd = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.endTrigger.triggerNo = 0x0,</td>
<td>RF_cmdPropRxAdvendTrigger.triggerNo = 0x0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.endTrigger.pastTrig = 0x0,</td>
<td>RF_cmdPropRxAdv.endTrigger.pastTrig = 0x0,</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.endTime = 0x00000000,</td>
<td>RF_cmdPropRxAdv.endTime = 0x00000000,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRxAdv.pAddr = 0,</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>RF_cmdPropRx.pQueue = 0,</td>
<td>RF_cmdPropRxAdv.pQueue = 0,</td>
</tr>
<tr class="row-odd"><td>RF_cmdPropRx.pOutput = 0</td>
<td>RF_cmdPropRxAdv.pOutput = 0</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="how-to-use-length-information">
<h2>How to use length information<a class="headerlink" href="#how-to-use-length-information" title="Permalink to this headline">¶</a></h2>
<div class="section" id="case-1-1-byte-length-after-sync-word">
<h3>Case 1: 1 byte length after sync word.<a class="headerlink" href="#case-1-1-byte-length-after-sync-word" title="Permalink to this headline">¶</a></h3>
<p>A packet that can be received by using CMD_PROP_RX using variable length has the length byte placed directly after the sync word.
To be able to receive this using CMD_PROP_RX_ADV the following fields must be set:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">pktConf</span><span class="p">.</span><span class="n">bCrcIncHdr</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>       <span class="c1">// The CRC is calculated over the length byte + the payload</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numHdrBits</span> <span class="o">=</span> <span class="mh">0x8</span><span class="p">;</span>       <span class="c1">// The header is 1 byte wide</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numLenBits</span> <span class="o">=</span> <span class="mh">0x8</span><span class="p">;</span>       <span class="c1">// The length is 1 byte (no other info in header)</span>
</pre></div>
</div>
</div>
<div class="section" id="case-2-3-byte-header-length-information-not-directly-after-sync-word">
<h3>Case 2: 3 byte header, length information not directly after sync word.<a class="headerlink" href="#case-2-3-byte-header-length-information-not-directly-after-sync-word" title="Permalink to this headline">¶</a></h3>
<p>With the advanced RX command, it is possible to receive packets with a length byte that is longer than 8 bits, and the length information
does not have to be located at the start of the header. Consider the packet shown in the figure below being transmitted on the air,
where the header is 3 bytes, and the length byte is the two last bytes of the header:</p>
<div class="figure align-center" id="rx-adv-3byteheader1">
<span id="fig-rx-adv-3byteheader1"></span><img alt="../../_images/fig_rx_adv_3byteheader1.jpg" src="../../_images/fig_rx_adv_3byteheader1.jpg" />
</div>
<p>To be able to receive this packet, and interpret the length correctly, the following must be set:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numHdrBits</span>      <span class="o">=</span> <span class="mh">0x18</span><span class="p">;</span>         <span class="c1">// The header is 3 bytes wide</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numLenBits</span>      <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>         <span class="c1">// The length is 2 bytes</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">lenPos</span>          <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>         <span class="c1">// The length starts at bit position 0</span>
</pre></div>
</div>
</div>
<div class="section" id="case-3-3-byte-header-length-information-directly-after-sync-word">
<h3>Case 3: 3 byte header, length information directly after sync word.<a class="headerlink" href="#case-3-3-byte-header-length-information-directly-after-sync-word" title="Permalink to this headline">¶</a></h3>
<p>Consider the packet shown in the figure below being transmitted on the air, where the header is 3 bytes,
and the length byte is the two last bytes of the header:</p>
<div class="figure align-center" id="rx-adv-3byteheader2">
<span id="fig-rx-adv-3byteheader2"></span><img alt="../../_images/fig_rx_adv_3byteheader2.jpg" src="../../_images/fig_rx_adv_3byteheader2.jpg" />
</div>
<p>The packet will be stored in the receive buffer as shown below:</p>
<p>0xXX, 0x05, 0x00, data1, data2, data3, data4, data5</p>
<p>To be able to receive this packet, and interpret the length correctly, the following must be set:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numHdrBits</span>      <span class="o">=</span> <span class="mh">0x18</span><span class="p">;</span> <span class="c1">// The header is 3 bytes wide</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numLenBits</span>      <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span> <span class="c1">// The length is 2 bytes</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">lenPos</span>          <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span> <span class="c1">// The length starts at bit position 8</span>
</pre></div>
</div>
</div>
<div class="section" id="case-4-3-byte-header-length-includes-crc">
<h3>Case 4: 3 byte header, length includes CRC<a class="headerlink" href="#case-4-3-byte-header-length-includes-crc" title="Permalink to this headline">¶</a></h3>
<p>The radio interprets the length information to be the number of bytes to be received between the Header and the CRC.
This is not necessarily the case. Consider the packet in Figure z</p>
<div class="figure align-center" id="rx-adv-3byteheader3">
<span id="fig-rx-adv-3byteheader3"></span><img alt="../../_images/fig_rx_adv_3byteheader3.jpg" src="../../_images/fig_rx_adv_3byteheader3.jpg" />
</div>
<p>In this case, the packets length information gives the total number of bytes received after the Header,
including the CRC (2 bytes). To account for this, the signed number .lenOffset can be added to the received
length to give the number of bytes after the header and before the CRC. In the case above,
.lenOffset should be -2:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numHdrBits</span>      <span class="o">=</span> <span class="mh">0x18</span><span class="p">;</span> <span class="c1">// The header is 3 bytes wide</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numLenBits</span>      <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span> <span class="c1">// The length is 2 bytes</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">lenPos</span>          <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span> <span class="c1">// The length starts at bit position 8</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">lenOffset</span>                       <span class="o">=</span> <span class="mh">0xFE</span><span class="p">;</span> <span class="c1">// Add -2 to the length info to exclude the CRC bytes</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-do-address-filtering">
<h2>How to do address filtering<a class="headerlink" href="#how-to-do-address-filtering" title="Permalink to this headline">¶</a></h2>
<p>Assume the following packet:</p>
<div class="figure align-center" id="address-filtering">
<span id="fig-address-filtering"></span><img alt="../../_images/fig_address_filtering.jpg" src="../../_images/fig_address_filtering.jpg" />
</div>
<p>One length byte is sent, followed by a 3 bytes long address.
There are several ways the receiver can be configured to receive this packet.</p>
<div class="section" id="case-1-the-length-and-address-is-part-of-the-header">
<h3>Case 1: The length and address is part of the header<a class="headerlink" href="#case-1-the-length-and-address-is-part-of-the-header" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">pktConf</span><span class="p">.</span><span class="n">bCrcIncHdr</span>      <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>  <span class="c1">// The CRC is calculated over the header + the payload</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numHdrBits</span>      <span class="o">=</span> <span class="mh">0x20</span><span class="p">;</span> <span class="c1">// The header is 4 bytes wide</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numLenBits</span>      <span class="o">=</span> <span class="mh">0x8</span><span class="p">;</span>  <span class="c1">// The length is 1 byte</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">lenPos</span>          <span class="o">=</span> <span class="mh">0x18</span><span class="p">;</span> <span class="c1">// The length is the first header byte received</span>
                                                                                        <span class="c1">// but will be stored last in the receive buffer</span>
</pre></div>
</div>
<p>The transmitted length gives the number of bytes after the length byte, excluding the CRC.
The receiver needs to know the number of bytes between the header and the CRC, so the .lenOffset is set to -3:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">lenOffset</span>                       <span class="o">=</span> <span class="mh">0xFD</span><span class="p">;</span> <span class="c1">// Add -3 to the length info to exclude the 3 address bytes</span>

<span class="n">RF_cmdPropRxAdv</span> <span class="n">addrConf</span><span class="p">.</span><span class="n">addrType</span>       <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>  <span class="c1">// Address is part of the header</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">addrSize</span>       <span class="o">=</span> <span class="mh">0x18</span><span class="p">;</span> <span class="c1">// Address is 24 bits</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">addrPos</span>        <span class="o">=</span> <span class="mh">0x0</span><span class="p">;</span>  <span class="c1">// The address starts at bit position 0</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">numAddr</span>        <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>  <span class="c1">// 1 address in the address list</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">pAddr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">addressList</span><span class="p">;</span>

<span class="k">static</span> <span class="kt">uint32_t</span> <span class="n">addressList</span><span class="p">[]</span> <span class="o">=</span>
<span class="p">{</span>
        <span class="mh">0xA1A2A3</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
<p>It is possible to add more addresses to the address list:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">uint32_t</span> <span class="n">addressList</span><span class="p">[]</span> <span class="o">=</span>
<span class="p">{</span>
        <span class="mh">0xA1A2A3</span><span class="p">,</span>
        <span class="mh">0xB1B2B3</span><span class="p">,</span>
        <span class="mh">0xC1C2C3</span><span class="p">,</span>
<span class="p">};</span>

<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">numAddr</span> <span class="o">=</span> <span class="mh">0x3</span><span class="p">;</span> <span class="c1">//   3 addresses in the address list</span>
</pre></div>
</div>
<p>The receiver will then accept packets with all 3 addresses, and addressInd
(Bit 0-4 in the received status byte) will indicate which address was received.
To append the status byte to the payload:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="n">rxConf</span><span class="p">.</span><span class="n">bAppendStatus</span> <span class="o">=</span> <span class="mh">0x1</span>
</pre></div>
</div>
</div>
<div class="section" id="case-2-address-as-part-of-payload">
<h3>Case 2: Address as part of payload<a class="headerlink" href="#case-2-address-as-part-of-payload" title="Permalink to this headline">¶</a></h3>
<p>The address can also be consider to be part of the payload and not the header</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">pktConf</span><span class="p">.</span><span class="n">bCrcIncHdr</span>              <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>  <span class="c1">// The CRC is calculated over the header byte + the payload</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numHdrBits</span>      <span class="o">=</span> <span class="mh">0x8</span><span class="p">;</span>  <span class="c1">// The header is 1 byte wide</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numLenBits</span>      <span class="o">=</span> <span class="mh">0x8</span><span class="p">;</span>  <span class="c1">// The length is 1 byte</span>
</pre></div>
</div>
<p>Since the address is no longer part of the header, .lenOffset must be set back to 0:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">lenOffset</span>               <span class="o">=</span> <span class="mh">0x0</span>

<span class="n">RF_cmdPropRxAdv</span> <span class="n">addrConf</span><span class="p">.</span><span class="n">addrType</span>       <span class="o">=</span> <span class="mh">0x0</span><span class="p">;</span> <span class="c1">// Address comes after the header</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">addrSize</span>       <span class="o">=</span> <span class="mh">0x3</span><span class="p">;</span> <span class="c1">// Address is 3 bytes</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">numAddr</span>        <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span> <span class="c1">// 1 Address in the address list</span>

<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">pAddr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">addressList</span><span class="p">;</span>
</pre></div>
</div>
<p>As mentioned earlier, the header is stored using little-endian byte order to the receive buffer. This is not the case when the address is not part of the header.
The address in the address list must therefore be swapped:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">uint32_t</span> <span class="n">addressList</span><span class="p">[]</span> <span class="o">=</span>
<span class="p">{</span>
        <span class="mh">0xA3A2A1</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="case-3-use-of-2-sync-words-and-address-filtering">
<h3>Case 3: Use of 2 sync words and address filtering<a class="headerlink" href="#case-3-use-of-2-sync-words-and-address-filtering" title="Permalink to this headline">¶</a></h3>
<p>The advanced RX command has two sync word fields (syncWord0 and syncWord1).
If one of the following conditions is fulfilled</p>
<ul class="simple">
<li>syncWord1 ≠ 0 and addrConf.addrType = 1</li>
<li>syncWord1 ≠ 0, addrConf.addrType = 0, and addrConf.addrPos ≠ 0</li>
</ul>
<p>one extra bit identifying the sync word is concatenated with the address as the MSB.</p>
<p>Assume that syncWord1 ≠ 0 and addrConf.addrType = 1:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">pktConf</span><span class="p">.</span><span class="n">bCrcIncHdr</span>              <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>  <span class="c1">// The CRC is calculated over the header + the payload</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numHdrBits</span>      <span class="o">=</span> <span class="mh">0x20</span><span class="p">;</span> <span class="c1">// The header is 4 bytes wide</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">numLenBits</span>      <span class="o">=</span> <span class="mh">0x8</span><span class="p">;</span>  <span class="c1">// The length is 1 byte</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">hdrConf</span><span class="p">.</span><span class="n">lenPos</span>          <span class="o">=</span> <span class="mh">0x18</span><span class="p">;</span> <span class="c1">// The length is the first header byte received but</span>
                                                                                                <span class="c1">// will be stored last in the receive buffer</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">lenOffset</span>               <span class="o">=</span> <span class="mh">0xFD</span><span class="p">;</span> <span class="c1">// Add -3 to the length info to exclude</span>
                                                <span class="c1">// the 3 address bytes</span>
<span class="n">RF_cmdPropRxAdv</span> <span class="n">addrConf</span><span class="p">.</span><span class="n">addrType</span>       <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>  <span class="c1">// Address is part of the header</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">addrSize</span>       <span class="o">=</span> <span class="mh">0x18</span><span class="p">;</span> <span class="c1">// Address is 24 bits</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">addrPos</span>        <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// The address starts at bit position 0</span>
<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">numAddr</span>        <span class="o">=</span> <span class="mh">0x2</span><span class="p">;</span>  <span class="c1">// 2 addresses in the address list</span>

<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">pAddr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">addressList</span><span class="p">;</span>

<span class="k">static</span> <span class="kt">uint32_t</span> <span class="n">addressList</span><span class="p">[]</span> <span class="o">=</span>
<span class="p">{</span>
        <span class="mh">0x00A1A2A3</span><span class="p">,</span> <span class="c1">// syncWord0 + Address 0xA1A2A3</span>
        <span class="mh">0x01A1A2A3</span><span class="p">,</span> <span class="c1">// syncWord1 + Address 0xA1A2A3</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Sending the packet with syncWord0:      addressInd = 0 and syncWordId = 0
Sending the packet with syncWord0:      addressInd = 1 and syncWordId = 1</p>
<p>If setting the address list to:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">uint32_t</span> <span class="n">addressList</span><span class="p">[]</span> <span class="o">=</span>
<span class="p">{</span>
        <span class="mh">0x01A1A2A3</span><span class="p">,</span> <span class="c1">// syncWord1 + Address 0xA1A2A3</span>
<span class="p">};</span>

<span class="n">RF_cmdPropRxAdv</span><span class="p">.</span><span class="n">addrConf</span><span class="p">.</span><span class="n">numAddr</span>        <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>
</pre></div>
</div>
<p>Then only packets with syncWord1 will be received, and addressInd = 0 and syncWordId = 1</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../proprietary-rf-guide/glossary-cc2640.html" class="btn btn-neutral float-right" title="Terms and acronyms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cmd_prop_cs.html" class="btn btn-neutral float-left" title="CMD_PROP_CS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        <a href="https://www.ti.com/corp/docs/legal/copyright.shtml">2016-2020, Texas Instruments</a>, Texas Instruments Incorporated. All rights reserved. <br>
        <a href="https://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="https://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="https://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="https://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>